# RQ Production Environment Configuration

# Worker Configuration
WORKER_MODE=hybrid
RQ_WORKER_COUNT=6
RQ_WORKER_TIMEOUT=600
RQ_WORKER_MEMORY_LIMIT=512
RQ_ENABLE_INTEGRATED_WORKERS=true
RQ_ENABLE_EXTERNAL_WORKERS=true
RQ_STARTUP_DELAY=10

# Queue Configuration
RQ_DEFAULT_TIMEOUT=600
RQ_RESULT_TTL=172800
RQ_JOB_TTL=14400
RQ_HEALTH_CHECK_INTERVAL=60

# Redis Configuration
REDIS_MEMORY_THRESHOLD=0.8
RQ_FAILURE_THRESHOLD=3

# Worker Scaling (Production)
RQ_MIN_URGENT_WORKERS=2
RQ_MAX_URGENT_WORKERS=4
RQ_MIN_HIGH_WORKERS=3
RQ_MAX_HIGH_WORKERS=6
RQ_MIN_NORMAL_WORKERS=4
RQ_MAX_NORMAL_WORKERS=8
RQ_MIN_LOW_WORKERS=2
RQ_MAX_LOW_WORKERS=4

# External Worker Configuration
RQ_EXTERNAL_URGENT_HIGH_WORKERS=2
RQ_EXTERNAL_NORMAL_WORKERS=2
RQ_EXTERNAL_LOW_WORKERS=3
RQ_EXTERNAL_WORKER_MEMORY_LIMIT=1024
RQ_EXTERNAL_WORKER_TIMEOUT=1800

# Logging Configuration
RQ_LOG_LEVEL=WARNING
RQ_LOG_FILE=/var/log/vedfolnir/rq_workers.log
RQ_LOG_MAX_SIZE=52428800
RQ_LOG_BACKUP_COUNT=10
RQ_ENABLE_SYSLOG=true
RQ_SYSLOG_ADDRESS=/dev/log
RQ_ENABLE_JSON_LOGGING=true

# Monitoring Configuration
RQ_ENABLE_METRICS=true
RQ_METRICS_PORT=9090
RQ_ENABLE_HEALTH_CHECKS=true
RQ_HEALTH_CHECK_PORT=8080
RQ_ENABLE_ALERTING=true
RQ_ALERT_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/PRODUCTION/WEBHOOK

# Scaling Configuration
RQ_ENABLE_AUTO_SCALING=true
RQ_SCALING_THRESHOLD_UP=0.8
RQ_SCALING_THRESHOLD_DOWN=0.3
RQ_SCALING_COOLDOWN=300

# Alert Thresholds (Production - Strict)
RQ_ALERT_MEMORY_USAGE_PERCENT_THRESHOLD=85.0
RQ_ALERT_CPU_USAGE_PERCENT_THRESHOLD=80.0
RQ_ALERT_QUEUE_BACKLOG_SIZE_THRESHOLD=1000
RQ_ALERT_WORKER_FAILURE_RATE_THRESHOLD=0.1

# Gunicorn Configuration
GUNICORN_WORKERS=8
GUNICORN_BIND=0.0.0.0:8000
GUNICORN_TIMEOUT=180
GUNICORN_ACCESS_LOG=/var/log/vedfolnir/gunicorn_access.log
GUNICORN_ERROR_LOG=/var/log/vedfolnir/gunicorn_error.log

# Production Security
RQ_SHUTDOWN_TIMEOUT=60
RQ_GRACEFUL_SHUTDOWN=true

# Performance Tuning
RQ_CONNECTION_POOL_SIZE=20
RQ_CONNECTION_POOL_MAX_OVERFLOW=10
RQ_REDIS_SOCKET_KEEPALIVE=true
RQ_REDIS_SOCKET_KEEPALIVE_OPTIONS=1,3,5