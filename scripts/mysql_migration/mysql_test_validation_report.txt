=== MySQL Test Configuration Validation Report ===

Validation Results: 6/8 passed
Issues Found: 3

VALIDATION RESULTS:
  ‚úÖ PASS: Mysql Server
  ‚úÖ PASS: Database Creation
  ‚úÖ PASS: Test Fixtures
  ‚úÖ PASS: Base Test Classes
  ‚ùå FAIL: Integration Test Base
  ‚úÖ PASS: Test Utilities
  ‚úÖ PASS: Environment Config
  ‚ùå FAIL: Sample Test Suite

üö® ISSUES FOUND:

  - Integration test base issue: Traceback (most recent call last):
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'test_ValidationIntegrationTest_test_integration_setup@example...' for key 'ix_users_email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/tests/mysql_test_base.py", line 119, in _create_basic_test_data
    self.test_user = self.fixtures.create_test_user(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/tests/mysql_test_config.py", line 263, in create_test_user
    session.commit()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'test_ValidationIntegrationTest_test_integration_setup@example...' for key 'ix_users_email'")
[SQL: INSERT INTO users (username, email, password_hash, role, is_active, created_at, last_login, email_verified, email_verification_token, email_verification_sent_at, first_name, last_name, password_reset_token, password_reset_sent_at, password_reset_used, data_processing_consent, data_processing_consent_date, account_locked, failed_login_attempts, last_failed_login) VALUES (%(username)s, %(email)s, %(password_hash)s, %(role)s, %(is_active)s, %(created_at)s, %(last_login)s, %(email_verified)s, %(email_verification_token)s, %(email_verification_sent_at)s, %(first_name)s, %(last_name)s, %(password_reset_token)s, %(password_reset_sent_at)s, %(password_reset_used)s, %(data_processing_consent)s, %(data_processing_consent_date)s, %(account_locked)s, %(failed_login_attempts)s, %(last_failed_login)s)]
[parameters: {'username': 'testuser_ValidationIntegrationTest_test_integration_setup', 'email': 'test_ValidationIntegrationTest_test_integration_setup@example.com', 'password_hash': 'pbkdf2:sha256:600000$O4zHy9OySHmqp2h8$35ef2a9dbe458a026cf5ff389b5288745ee424c1c58e2ffb86a3b54ea61fd4d6', 'role': 'REVIEWER', 'is_active': 1, 'created_at': datetime.datetime(2025, 8, 22, 16, 6, 33, 257580), 'last_login': None, 'email_verified': 1, 'email_verification_token': None, 'email_verification_sent_at': None, 'first_name': None, 'last_name': None, 'password_reset_token': None, 'password_reset_sent_at': None, 'password_reset_used': 0, 'data_processing_consent': 0, 'data_processing_consent_date': None, 'account_locked': 0, 'failed_login_attempts': 0, 'last_failed_login': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/tests/mysql_test_base.py", line 226, in setUp
    super().setUp()
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/tests/mysql_test_base.py", line 90, in setUp
    self._create_basic_test_data()
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/tests/mysql_test_base.py", line 131, in _create_basic_test_data
    logger.warning(f"Could not create basic test data: {e}")
    ^^^^^^
NameError: name 'logger' is not defined

  - Sample test failure: Traceback (most recent call last):
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'test_SampleTestSuite_test_platform_operations@example.com' for key 'ix_users_email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/tests/mysql_test_base.py", line 119, in _create_basic_test_data
    self.test_user = self.fixtures.create_test_user(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/tests/mysql_test_config.py", line 263, in create_test_user
    session.commit()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'test_SampleTestSuite_test_platform_operations@example.com' for key 'ix_users_email'")
[SQL: INSERT INTO users (username, email, password_hash, role, is_active, created_at, last_login, email_verified, email_verification_token, email_verification_sent_at, first_name, last_name, password_reset_token, password_reset_sent_at, password_reset_used, data_processing_consent, data_processing_consent_date, account_locked, failed_login_attempts, last_failed_login) VALUES (%(username)s, %(email)s, %(password_hash)s, %(role)s, %(is_active)s, %(created_at)s, %(last_login)s, %(email_verified)s, %(email_verification_token)s, %(email_verification_sent_at)s, %(first_name)s, %(last_name)s, %(password_reset_token)s, %(password_reset_sent_at)s, %(password_reset_used)s, %(data_processing_consent)s, %(data_processing_consent_date)s, %(account_locked)s, %(failed_login_attempts)s, %(last_failed_login)s)]
[parameters: {'username': 'testuser_SampleTestSuite_test_platform_operations', 'email': 'test_SampleTestSuite_test_platform_operations@example.com', 'password_hash': 'pbkdf2:sha256:600000$nKAgMBdZ01tR3Tjq$31ee5df5311665e4d806eee787f2405501956def07554e0ec2f26e0e4af0fb48', 'role': 'REVIEWER', 'is_active': 1, 'created_at': datetime.datetime(2025, 8, 22, 16, 6, 33, 527820), 'last_login': None, 'email_verified': 1, 'email_verification_token': None, 'email_verification_sent_at': None, 'first_name': None, 'last_name': None, 'password_reset_token': None, 'password_reset_sent_at': None, 'password_reset_used': 0, 'data_processing_consent': 0, 'data_processing_consent_date': None, 'account_locked': 0, 'failed_login_attempts': 0, 'last_failed_login': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/tests/mysql_test_base.py", line 90, in setUp
    self._create_basic_test_data()
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/tests/mysql_test_base.py", line 131, in _create_basic_test_data
    logger.warning(f"Could not create basic test data: {e}")
    ^^^^^^
NameError: name 'logger' is not defined

  - Sample test failure: Traceback (most recent call last):
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1062, "Duplicate entry 'sample@example.com' for key 'ix_users_email'")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Volumes/Gold/DevContainerTesting/vedfolnir/scripts/mysql_migration/validate_mysql_test_configuration.py", line 346, in test_user_management
    self.session.commit()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/Users/iolaire/.pyenv/versions/3.12.5/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry 'sample@example.com' for key 'ix_users_email'")
[SQL: INSERT INTO users (username, email, password_hash, role, is_active, created_at, last_login, email_verified, email_verification_token, email_verification_sent_at, first_name, last_name, password_reset_token, password_reset_sent_at, password_reset_used, data_processing_consent, data_processing_consent_date, account_locked, failed_login_attempts, last_failed_login) VALUES (%(username)s, %(email)s, %(password_hash)s, %(role)s, %(is_active)s, %(created_at)s, %(last_login)s, %(email_verified)s, %(email_verification_token)s, %(email_verification_sent_at)s, %(first_name)s, %(last_name)s, %(password_reset_token)s, %(password_reset_sent_at)s, %(password_reset_used)s, %(data_processing_consent)s, %(data_processing_consent_date)s, %(account_locked)s, %(failed_login_attempts)s, %(last_failed_login)s)]
[parameters: {'username': 'sampleuser', 'email': 'sample@example.com', 'password_hash': 'pbkdf2:sha256:600000$4DPEFnKQjGa4nqQs$39f41998458d04d2f88b95522f219312af19938c835819702dab42de4265138c', 'role': 'VIEWER', 'is_active': 1, 'created_at': datetime.datetime(2025, 8, 22, 16, 6, 33, 699320), 'last_login': None, 'email_verified': 0, 'email_verification_token': None, 'email_verification_sent_at': None, 'first_name': None, 'last_name': None, 'password_reset_token': None, 'password_reset_sent_at': None, 'password_reset_used': 0, 'data_processing_consent': 0, 'data_processing_consent_date': None, 'account_locked': 0, 'failed_login_attempts': 0, 'last_failed_login': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)


‚ùå ISSUES DETECTED: MySQL test configuration needs attention

Please address the issues listed above before running tests.
Common solutions:
- Ensure MySQL server is running and accessible
- Verify MySQL test user has proper permissions
- Check environment variable configuration
- Install required Python dependencies (pymysql, cryptography)