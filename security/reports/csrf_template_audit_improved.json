{
  "scan_metadata": {
    "scan_timestamp": "2025-08-12T08:08:24.678412",
    "templates_directory": "templates",
    "total_templates_scanned": 29
  },
  "summary": {
    "scan_summary": {
      "total_templates": 29,
      "protected_templates": 28,
      "protection_rate": 0.9655172413793104,
      "average_compliance_score": 0.8896551724137931,
      "high_compliance_templates": 24,
      "scan_timestamp": "2025-08-12T08:08:24.678428"
    },
    "vulnerability_summary": {
      "total_vulnerabilities": 11,
      "by_severity": {
        "HIGH": 9,
        "MEDIUM": 1,
        "CRITICAL": 1
      },
      "by_type": {
        "exposed_csrf_token": 9,
        "csrf_in_comment": 1,
        "missing_csrf_protection": 1
      }
    },
    "form_summary": {
      "total_forms": 19,
      "post_forms": 13,
      "get_forms": 6
    },
    "csrf_methods": {
      "hidden_tag": 4,
      "csrf_token_direct": 4,
      "meta_only": 0,
      "none": 21,
      "error": 0
    },
    "top_vulnerabilities": [
      [
        "exposed_csrf_token",
        9
      ],
      [
        "csrf_in_comment",
        1
      ],
      [
        "missing_csrf_protection",
        1
      ]
    ]
  },
  "detailed_results": [
    {
      "template_path": "templates/404.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.644073"
    },
    {
      "template_path": "templates/500.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.644281"
    },
    {
      "template_path": "templates/admin/session_monitoring_dashboard.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [
        "/admin/session-monitoring/alerts"
      ],
      "last_audited": "2025-08-12T08:08:24.645124"
    },
    {
      "template_path": "templates/admin_cleanup.html",
      "csrf_protected": true,
      "csrf_method": "csrf_token_direct",
      "vulnerabilities": [
        {
          "type": "exposed_csrf_token",
          "severity": "HIGH",
          "description": "CSRF token is visible in HTML output instead of being in a hidden field",
          "line_number": 123,
          "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
          "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        },
        {
          "type": "exposed_csrf_token",
          "severity": "HIGH",
          "description": "CSRF token is visible in HTML output instead of being in a hidden field",
          "line_number": 146,
          "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
          "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        },
        {
          "type": "exposed_csrf_token",
          "severity": "HIGH",
          "description": "CSRF token is visible in HTML output instead of being in a hidden field",
          "line_number": 176,
          "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
          "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        },
        {
          "type": "exposed_csrf_token",
          "severity": "HIGH",
          "description": "CSRF token is visible in HTML output instead of being in a hidden field",
          "line_number": 206,
          "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
          "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        },
        {
          "type": "exposed_csrf_token",
          "severity": "HIGH",
          "description": "CSRF token is visible in HTML output instead of being in a hidden field",
          "line_number": 224,
          "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
          "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        },
        {
          "type": "exposed_csrf_token",
          "severity": "HIGH",
          "description": "CSRF token is visible in HTML output instead of being in a hidden field",
          "line_number": 262,
          "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
          "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        }
      ],
      "recommendations": [
        "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
        "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
        "Ensure all POST forms validate CSRF tokens on the server side"
      ],
      "compliance_score": 0.0,
      "form_count": 6,
      "post_form_count": 6,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.646332"
    },
    {
      "template_path": "templates/admin_monitoring.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [
        "/api/admin/system_overview",
        "/api/admin/user_activity?days=7",
        "/api/admin/cleanup_tasks",
        "/api/admin/active_tasks"
      ],
      "last_audited": "2025-08-12T08:08:24.649340"
    },
    {
      "template_path": "templates/base.html",
      "csrf_protected": true,
      "csrf_method": "csrf_token_direct",
      "vulnerabilities": [
        {
          "type": "exposed_csrf_token",
          "severity": "HIGH",
          "description": "CSRF token is visible in HTML output instead of being in a hidden field",
          "line_number": 10,
          "code_snippet": "<meta name=\"csrf-token\" content=\"{{ csrf_token() }}\">",
          "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        }
      ],
      "recommendations": [
        "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
        "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
      ],
      "compliance_score": 0.6000000000000001,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.652623"
    },
    {
      "template_path": "templates/batch_review.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [
        "Verify GET forms are idempotent and do not change server state"
      ],
      "compliance_score": 1.0,
      "form_count": 1,
      "post_form_count": 0,
      "get_form_count": 1,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.654656"
    },
    {
      "template_path": "templates/caption_generation.html",
      "csrf_protected": true,
      "csrf_method": "hidden_tag",
      "vulnerabilities": [],
      "recommendations": [
        "Ensure all POST forms validate CSRF tokens on the server side"
      ],
      "compliance_score": 1.0,
      "form_count": 1,
      "post_form_count": 1,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.656422"
    },
    {
      "template_path": "templates/caption_settings.html",
      "csrf_protected": true,
      "csrf_method": "hidden_tag",
      "vulnerabilities": [],
      "recommendations": [
        "Ensure all POST forms validate CSRF tokens on the server side"
      ],
      "compliance_score": 1.0,
      "form_count": 1,
      "post_form_count": 1,
      "get_form_count": 0,
      "ajax_endpoints": [
        "/api/caption_settings",
        "/api/validate_caption_settings"
      ],
      "last_audited": "2025-08-12T08:08:24.657396"
    },
    {
      "template_path": "templates/components/add_platform_modal.html",
      "csrf_protected": true,
      "csrf_method": "csrf_token_direct",
      "vulnerabilities": [
        {
          "type": "exposed_csrf_token",
          "severity": "HIGH",
          "description": "CSRF token is visible in HTML output instead of being in a hidden field",
          "line_number": 14,
          "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
          "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        }
      ],
      "recommendations": [
        "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
        "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
      ],
      "compliance_score": 0.6000000000000001,
      "form_count": 1,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.657763"
    },
    {
      "template_path": "templates/errors/400.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.657986"
    },
    {
      "template_path": "templates/errors/401.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.658221"
    },
    {
      "template_path": "templates/errors/403.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.658463"
    },
    {
      "template_path": "templates/errors/404.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.658709"
    },
    {
      "template_path": "templates/errors/429.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.658939"
    },
    {
      "template_path": "templates/errors/500.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.659165"
    },
    {
      "template_path": "templates/errors/session_error.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.659510"
    },
    {
      "template_path": "templates/first_time_setup.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.661184"
    },
    {
      "template_path": "templates/health_dashboard.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.662046"
    },
    {
      "template_path": "templates/includes/favicon_meta.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.662405"
    },
    {
      "template_path": "templates/index.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.663553"
    },
    {
      "template_path": "templates/login.html",
      "csrf_protected": true,
      "csrf_method": "hidden_tag",
      "vulnerabilities": [],
      "recommendations": [
        "Ensure all POST forms validate CSRF tokens on the server side"
      ],
      "compliance_score": 1.0,
      "form_count": 1,
      "post_form_count": 1,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.664066"
    },
    {
      "template_path": "templates/platform_management.html",
      "csrf_protected": true,
      "csrf_method": "csrf_token_direct",
      "vulnerabilities": [
        {
          "type": "exposed_csrf_token",
          "severity": "HIGH",
          "description": "CSRF token is visible in HTML output instead of being in a hidden field",
          "line_number": 210,
          "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
          "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        },
        {
          "type": "csrf_in_comment",
          "severity": "MEDIUM",
          "description": "CSRF token or reference found in HTML comment",
          "line_number": 17,
          "code_snippet": null,
          "recommendation": "Remove CSRF references from HTML comments"
        }
      ],
      "recommendations": [
        "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
        "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
        "Remove CSRF references from HTML comments"
      ],
      "compliance_score": 0.5,
      "form_count": 1,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.664982"
    },
    {
      "template_path": "templates/profile.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 1,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [
        "/api/update_user_settings"
      ],
      "last_audited": "2025-08-12T08:08:24.668847"
    },
    {
      "template_path": "templates/review.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [],
      "compliance_score": 1.0,
      "form_count": 0,
      "post_form_count": 0,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.669535"
    },
    {
      "template_path": "templates/review_batch.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [
        "Verify GET forms are idempotent and do not change server state"
      ],
      "compliance_score": 1.0,
      "form_count": 1,
      "post_form_count": 0,
      "get_form_count": 1,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.675089"
    },
    {
      "template_path": "templates/review_batches.html",
      "csrf_protected": true,
      "csrf_method": "none",
      "vulnerabilities": [],
      "recommendations": [
        "Verify GET forms are idempotent and do not change server state"
      ],
      "compliance_score": 1.0,
      "form_count": 1,
      "post_form_count": 0,
      "get_form_count": 1,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.676486"
    },
    {
      "template_path": "templates/review_single.html",
      "csrf_protected": true,
      "csrf_method": "hidden_tag",
      "vulnerabilities": [],
      "recommendations": [
        "Ensure all POST forms validate CSRF tokens on the server side"
      ],
      "compliance_score": 1.0,
      "form_count": 1,
      "post_form_count": 1,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.677687"
    },
    {
      "template_path": "templates/user_management.html",
      "csrf_protected": false,
      "csrf_method": "none",
      "vulnerabilities": [
        {
          "type": "missing_csrf_protection",
          "severity": "CRITICAL",
          "description": "Found 3 POST forms but only 0 CSRF tokens",
          "line_number": null,
          "code_snippet": null,
          "recommendation": "Add {{ form.hidden_tag() }} to all POST forms"
        }
      ],
      "recommendations": [
        "Add CSRF protection to POST forms using {{ form.hidden_tag() }}",
        "Add {{ form.hidden_tag() }} to all POST forms",
        "Ensure all POST forms validate CSRF tokens on the server side"
      ],
      "compliance_score": 0.09999999999999998,
      "form_count": 3,
      "post_form_count": 3,
      "get_form_count": 0,
      "ajax_endpoints": [],
      "last_audited": "2025-08-12T08:08:24.678342"
    }
  ]
}