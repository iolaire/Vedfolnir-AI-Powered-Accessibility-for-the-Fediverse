{
  "report_metadata": {
    "report_type": "CSRF Security Audit",
    "generated_at": "2025-08-12T08:15:38.539280",
    "scan_timestamp": "2025-08-12T08:15:26.896578",
    "templates_scanned": 30,
    "report_version": "1.0"
  },
  "executive_summary": {
    "overall_risk_level": "CRITICAL",
    "protection_rate": 0.9666666666666667,
    "average_compliance_score": 0.89,
    "total_vulnerabilities": 12,
    "key_findings": [
      "1 critical CSRF vulnerabilities found",
      "9 high-severity CSRF vulnerabilities found"
    ],
    "immediate_actions_required": true,
    "templates_requiring_attention": 5
  },
  "compliance_analysis": {
    "overall_compliance_score": 0.89,
    "compliance_target": 0.9,
    "templates_meeting_target": 25,
    "score_distribution": {
      "excellent": 0,
      "good": 0,
      "fair": 3,
      "poor": 2
    },
    "csrf_method_distribution": {
      "hidden_tag": 4,
      "csrf_token_direct": 4,
      "meta_only": 0,
      "none": 22,
      "error": 0
    },
    "compliance_trends": {
      "current_score": 0.89,
      "target_score": 0.9,
      "improvement_needed": 0.010000000000000009
    },
    "compliance_gaps": [
      "5 templates below compliance threshold",
      "1 POST forms without CSRF protection"
    ]
  },
  "vulnerability_analysis": {
    "total_vulnerabilities": 12,
    "severity_distribution": {
      "HIGH": 9,
      "MEDIUM": 2,
      "CRITICAL": 1
    },
    "vulnerability_types": {
      "exposed_csrf_token": {
        "count": 9,
        "severity_distribution": {
          "HIGH": 9
        },
        "affected_templates": [
          "templates/admin_cleanup.html",
          "templates/base.html",
          "templates/components/add_platform_modal.html",
          "templates/platform_management.html"
        ],
        "description": "CSRF token is visible in HTML output instead of being in a hidden field",
        "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
      },
      "csrf_in_comment": {
        "count": 2,
        "severity_distribution": {
          "MEDIUM": 2
        },
        "affected_templates": [
          "templates/base.html",
          "templates/platform_management.html"
        ],
        "description": "CSRF token or reference found in HTML comment",
        "recommendation": "Remove CSRF references from HTML comments"
      },
      "missing_csrf_protection": {
        "count": 1,
        "severity_distribution": {
          "CRITICAL": 1
        },
        "affected_templates": [
          "templates/user_management.html"
        ],
        "description": "Found 3 POST forms but only 0 CSRF tokens",
        "recommendation": "Add {{ form.hidden_tag() }} to all POST forms"
      }
    },
    "risk_score": 24.0,
    "most_common_vulnerabilities": [
      [
        "exposed_csrf_token",
        9
      ],
      [
        "csrf_in_comment",
        2
      ],
      [
        "missing_csrf_protection",
        1
      ]
    ],
    "vulnerability_trends": {
      "trend_analysis": "Historical data needed for trend analysis",
      "current_snapshot": {
        "templates_with_vulnerabilities": 5,
        "average_vulnerabilities_per_template": 0.4
      }
    },
    "remediation_priority": [
      {
        "vulnerability_type": "missing_csrf_protection",
        "priority": "CRITICAL",
        "count": 1,
        "affected_templates": 1
      },
      {
        "vulnerability_type": "exposed_csrf_token",
        "priority": "HIGH",
        "count": 9,
        "affected_templates": 4
      },
      {
        "vulnerability_type": "csrf_in_comment",
        "priority": "MEDIUM",
        "count": 2,
        "affected_templates": 2
      }
    ]
  },
  "template_analysis": {
    "total_templates_analyzed": 30,
    "problematic_templates": [
      {
        "template_path": "templates/admin_cleanup.html",
        "compliance_score": 0.0,
        "vulnerability_count": 6,
        "csrf_method": "csrf_token_direct",
        "form_count": 6,
        "post_form_count": 6
      },
      {
        "template_path": "templates/user_management.html",
        "compliance_score": 0.09999999999999998,
        "vulnerability_count": 1,
        "csrf_method": "none",
        "form_count": 3,
        "post_form_count": 3
      },
      {
        "template_path": "templates/base.html",
        "compliance_score": 0.5,
        "vulnerability_count": 2,
        "csrf_method": "csrf_token_direct",
        "form_count": 0,
        "post_form_count": 0
      },
      {
        "template_path": "templates/platform_management.html",
        "compliance_score": 0.5,
        "vulnerability_count": 2,
        "csrf_method": "csrf_token_direct",
        "form_count": 1,
        "post_form_count": 0
      },
      {
        "template_path": "templates/components/add_platform_modal.html",
        "compliance_score": 0.6000000000000001,
        "vulnerability_count": 1,
        "csrf_method": "csrf_token_direct",
        "form_count": 1,
        "post_form_count": 0
      },
      {
        "template_path": "templates/404.html",
        "compliance_score": 1.0,
        "vulnerability_count": 0,
        "csrf_method": "none",
        "form_count": 0,
        "post_form_count": 0
      },
      {
        "template_path": "templates/500.html",
        "compliance_score": 1.0,
        "vulnerability_count": 0,
        "csrf_method": "none",
        "form_count": 0,
        "post_form_count": 0
      },
      {
        "template_path": "templates/admin/session_monitoring_dashboard.html",
        "compliance_score": 1.0,
        "vulnerability_count": 0,
        "csrf_method": "none",
        "form_count": 0,
        "post_form_count": 0
      },
      {
        "template_path": "templates/admin_monitoring.html",
        "compliance_score": 1.0,
        "vulnerability_count": 0,
        "csrf_method": "none",
        "form_count": 0,
        "post_form_count": 0
      },
      {
        "template_path": "templates/batch_review.html",
        "compliance_score": 1.0,
        "vulnerability_count": 0,
        "csrf_method": "none",
        "form_count": 1,
        "post_form_count": 0
      }
    ],
    "best_practice_templates": [
      {
        "template_path": "templates/404.html",
        "compliance_score": 1.0,
        "csrf_method": "none"
      },
      {
        "template_path": "templates/500.html",
        "compliance_score": 1.0,
        "csrf_method": "none"
      },
      {
        "template_path": "templates/admin/session_monitoring_dashboard.html",
        "compliance_score": 1.0,
        "csrf_method": "none"
      },
      {
        "template_path": "templates/admin_monitoring.html",
        "compliance_score": 1.0,
        "csrf_method": "none"
      },
      {
        "template_path": "templates/batch_review.html",
        "compliance_score": 1.0,
        "csrf_method": "none"
      }
    ],
    "template_categories": {
      "admin_templates": {
        "count": 3,
        "average_compliance": 0.6666666666666666,
        "vulnerability_count": 6
      },
      "form_templates": {
        "count": 6,
        "average_compliance": 0.6833333333333332,
        "vulnerability_count": 7
      },
      "ajax_templates": {
        "count": 4,
        "average_compliance": 1.0,
        "vulnerability_count": 0
      },
      "public_templates": {
        "count": 1,
        "average_compliance": 1.0,
        "vulnerability_count": 0
      }
    },
    "form_analysis": {
      "total_forms": 19,
      "post_forms": 13,
      "get_forms": 6,
      "templates_with_forms": 12,
      "templates_with_post_forms": 6,
      "average_forms_per_template": 0.6333333333333333
    },
    "ajax_analysis": {
      "templates_with_ajax": 4,
      "total_ajax_endpoints": 8,
      "average_ajax_per_template": 0.26666666666666666,
      "ajax_usage_rate": 0.13333333333333333
    }
  },
  "remediation_plan": {
    "total_remediation_tasks": 5,
    "remediation_phases": {
      "immediate": [
        {
          "template_path": "templates/user_management.html",
          "priority": 12,
          "impact_level": "CRITICAL",
          "effort_level": "LOW",
          "vulnerabilities": 1,
          "current_score": 0.09999999999999998,
          "target_score": 0.9,
          "specific_actions": [
            "Add CSRF protection to POST forms using {{ form.hidden_tag() }}",
            "Add {{ form.hidden_tag() }} to all POST forms",
            "Ensure all POST forms validate CSRF tokens on the server side"
          ]
        },
        {
          "template_path": "templates/components/add_platform_modal.html",
          "priority": 9,
          "impact_level": "HIGH",
          "effort_level": "LOW",
          "vulnerabilities": 1,
          "current_score": 0.6000000000000001,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          ]
        },
        {
          "template_path": "templates/base.html",
          "priority": 6,
          "impact_level": "HIGH",
          "effort_level": "MEDIUM",
          "vulnerabilities": 2,
          "current_score": 0.5,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Remove CSRF references from HTML comments"
          ]
        },
        {
          "template_path": "templates/platform_management.html",
          "priority": 6,
          "impact_level": "HIGH",
          "effort_level": "MEDIUM",
          "vulnerabilities": 2,
          "current_score": 0.5,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Remove CSRF references from HTML comments"
          ]
        },
        {
          "template_path": "templates/admin_cleanup.html",
          "priority": 3,
          "impact_level": "HIGH",
          "effort_level": "HIGH",
          "vulnerabilities": 6,
          "current_score": 0.0,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Ensure all POST forms validate CSRF tokens on the server side"
          ]
        }
      ],
      "short_term": [],
      "long_term": []
    },
    "estimated_effort": {
      "total_story_points": 16,
      "estimated_days": 8.0,
      "effort_by_level": {
        "LOW": 2,
        "MEDIUM": 2,
        "HIGH": 1
      }
    },
    "quick_wins": [
      {
        "template_path": "templates/components/add_platform_modal.html",
        "priority": 9,
        "impact_level": "HIGH",
        "effort_level": "LOW",
        "vulnerabilities": 1,
        "current_score": 0.6000000000000001,
        "target_score": 0.9,
        "specific_actions": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        ]
      }
    ],
    "implementation_timeline": {
      "immediate": "Week 1-2: Address critical and high-severity vulnerabilities",
      "short_term": "Week 3-6: Implement medium-priority fixes and improvements",
      "long_term": "Month 2-3: Complete remaining improvements and establish monitoring"
    }
  },
  "security_metrics": {
    "protection_coverage": {
      "total_templates": 30,
      "protected_templates": 29,
      "protection_rate": 0.9666666666666667,
      "unprotected_templates": 1
    },
    "vulnerability_metrics": {
      "total_vulnerabilities": 12,
      "vulnerabilities_per_template": 0.4,
      "critical_vulnerability_rate": 0.03333333333333333,
      "high_vulnerability_rate": 0.3
    },
    "compliance_metrics": {
      "average_compliance_score": 0.89,
      "high_compliance_templates": 25,
      "compliance_rate": 0.8333333333333334,
      "compliance_gap": 0.010000000000000009
    },
    "form_security_metrics": {
      "total_forms": 19,
      "post_forms": 13,
      "get_forms": 6,
      "forms_per_template": 0.6333333333333333
    }
  },
  "recommendations": [
    {
      "priority": "CRITICAL",
      "category": "Vulnerability Remediation",
      "title": "Fix Critical CSRF Vulnerabilities",
      "description": "Found 1 critical CSRF vulnerabilities that need immediate attention.",
      "implementation": "Review and fix all critical vulnerabilities listed in the detailed analysis",
      "impact": "Eliminates high-risk security vulnerabilities"
    },
    {
      "priority": "MEDIUM",
      "category": "Implementation Standards",
      "title": "Standardize CSRF Token Implementation",
      "description": "Found 4 templates using { csrf_token() } directly, which exposes tokens in HTML.",
      "implementation": "Replace {{ csrf_token() }} with {{ form.hidden_tag() }}",
      "impact": "Improves security by hiding CSRF tokens from HTML source"
    },
    {
      "priority": "HIGH",
      "category": "CSRF Protection",
      "title": "Add CSRF Protection to Unprotected Templates",
      "description": "Found 22 templates with no CSRF protection.",
      "implementation": "Add appropriate CSRF protection based on template functionality",
      "impact": "Provides comprehensive CSRF protection across the application"
    }
  ],
  "appendix": {
    "detailed_template_results": [
      {
        "template_path": "templates/404.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.865595"
      },
      {
        "template_path": "templates/500.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.865992"
      },
      {
        "template_path": "templates/admin/session_monitoring_dashboard.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [
          "/admin/session-monitoring/alerts"
        ],
        "last_audited": "2025-08-12T08:15:26.866858"
      },
      {
        "template_path": "templates/admin_cleanup.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 123,
            "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 146,
            "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 176,
            "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 206,
            "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 224,
            "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 262,
            "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 0.0,
        "form_count": 6,
        "post_form_count": 6,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.868131"
      },
      {
        "template_path": "templates/admin_monitoring.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [
          "/api/admin/cleanup_tasks",
          "/api/admin/system_overview",
          "/api/admin/active_tasks",
          "/api/admin/user_activity?days=7"
        ],
        "last_audited": "2025-08-12T08:15:26.870696"
      },
      {
        "template_path": "templates/base.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 10,
            "code_snippet": "<meta name=\"csrf-token\" content=\"{{ csrf_token() }}\">",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "csrf_in_comment",
            "severity": "MEDIUM",
            "description": "CSRF token or reference found in HTML comment",
            "line_number": 13,
            "code_snippet": null,
            "recommendation": "Remove CSRF references from HTML comments"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Remove CSRF references from HTML comments"
        ],
        "compliance_score": 0.5,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.872394"
      },
      {
        "template_path": "templates/batch_review.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [
          "Verify GET forms are idempotent and do not change server state"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 1,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.874683"
      },
      {
        "template_path": "templates/caption_generation.html",
        "csrf_protected": true,
        "csrf_method": "hidden_tag",
        "vulnerabilities": [],
        "recommendations": [
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 1,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.876145"
      },
      {
        "template_path": "templates/caption_settings.html",
        "csrf_protected": true,
        "csrf_method": "hidden_tag",
        "vulnerabilities": [],
        "recommendations": [
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 1,
        "get_form_count": 0,
        "ajax_endpoints": [
          "/api/validate_caption_settings",
          "/api/caption_settings"
        ],
        "last_audited": "2025-08-12T08:15:26.877298"
      },
      {
        "template_path": "templates/components/add_platform_modal.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 14,
            "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        ],
        "compliance_score": 0.6000000000000001,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.877675"
      },
      {
        "template_path": "templates/errors/400.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.877903"
      },
      {
        "template_path": "templates/errors/401.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.878125"
      },
      {
        "template_path": "templates/errors/403.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.878333"
      },
      {
        "template_path": "templates/errors/404.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.878532"
      },
      {
        "template_path": "templates/errors/429.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.878735"
      },
      {
        "template_path": "templates/errors/500.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.878936"
      },
      {
        "template_path": "templates/errors/csrf_error.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.879306"
      },
      {
        "template_path": "templates/errors/session_error.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.879755"
      },
      {
        "template_path": "templates/first_time_setup.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.881410"
      },
      {
        "template_path": "templates/health_dashboard.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.882309"
      },
      {
        "template_path": "templates/includes/favicon_meta.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.882648"
      },
      {
        "template_path": "templates/index.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.883814"
      },
      {
        "template_path": "templates/login.html",
        "csrf_protected": true,
        "csrf_method": "hidden_tag",
        "vulnerabilities": [],
        "recommendations": [
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 1,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.884364"
      },
      {
        "template_path": "templates/platform_management.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 210,
            "code_snippet": "<input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "csrf_in_comment",
            "severity": "MEDIUM",
            "description": "CSRF token or reference found in HTML comment",
            "line_number": 17,
            "code_snippet": null,
            "recommendation": "Remove CSRF references from HTML comments"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Remove CSRF references from HTML comments"
        ],
        "compliance_score": 0.5,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.885207"
      },
      {
        "template_path": "templates/profile.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [
          "/api/update_user_settings"
        ],
        "last_audited": "2025-08-12T08:15:26.887535"
      },
      {
        "template_path": "templates/review.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.888045"
      },
      {
        "template_path": "templates/review_batch.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [
          "Verify GET forms are idempotent and do not change server state"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 1,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.893340"
      },
      {
        "template_path": "templates/review_batches.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [
          "Verify GET forms are idempotent and do not change server state"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 1,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.894647"
      },
      {
        "template_path": "templates/review_single.html",
        "csrf_protected": true,
        "csrf_method": "hidden_tag",
        "vulnerabilities": [],
        "recommendations": [
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 1,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.895864"
      },
      {
        "template_path": "templates/user_management.html",
        "csrf_protected": false,
        "csrf_method": "none",
        "vulnerabilities": [
          {
            "type": "missing_csrf_protection",
            "severity": "CRITICAL",
            "description": "Found 3 POST forms but only 0 CSRF tokens",
            "line_number": null,
            "code_snippet": null,
            "recommendation": "Add {{ form.hidden_tag() }} to all POST forms"
          }
        ],
        "recommendations": [
          "Add CSRF protection to POST forms using {{ form.hidden_tag() }}",
          "Add {{ form.hidden_tag() }} to all POST forms",
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 0.09999999999999998,
        "form_count": 3,
        "post_form_count": 3,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:15:26.896513"
      }
    ],
    "vulnerability_reference": {
      "exposed_csrf_token": {
        "description": "CSRF token visible in HTML source code",
        "risk": "HIGH - Token can be extracted by malicious scripts",
        "fix": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
      },
      "missing_csrf_protection": {
        "description": "POST form without CSRF token",
        "risk": "CRITICAL - Form vulnerable to CSRF attacks",
        "fix": "Add {{ form.hidden_tag() }} to all POST forms"
      },
      "unnecessary_csrf_token": {
        "description": "CSRF token in GET form",
        "risk": "LOW - Unnecessary complexity, GET should be idempotent",
        "fix": "Remove CSRF token from GET forms"
      },
      "csrf_in_comment": {
        "description": "CSRF token reference in HTML comment",
        "risk": "MEDIUM - Information disclosure",
        "fix": "Remove CSRF references from HTML comments"
      }
    },
    "csrf_implementation_guide": {
      "best_practices": "Always use {{ form.hidden_tag() }} for POST forms",
      "ajax_implementation": "Use meta tag and X-CSRFToken header for AJAX requests",
      "validation": "Ensure server-side CSRF validation is enabled",
      "testing": "Test CSRF protection with automated security tests"
    },
    "testing_recommendations": [
      "Implement automated CSRF protection tests",
      "Test form submissions without CSRF tokens (should fail)",
      "Test AJAX requests with and without CSRF tokens",
      "Verify CSRF tokens are not visible in HTML source",
      "Test CSRF token expiration and refresh functionality"
    ]
  }
}