# Vedfolnir Production Environment Configuration
# This file contains production-specific environment variable examples
# SECURITY WARNING: Replace ALL example values with secure, unique values

# =============================================================================
# PRODUCTION ENVIRONMENT SETTINGS
# =============================================================================

# Environment Type
ENVIRONMENT=production
FLASK_ENV=production
FLASK_DEBUG=false

# Application Settings
FLASK_HOST=0.0.0.0
FLASK_PORT=5000
APP_VERSION=1.0.0

# Security Keys (MUST be generated securely for production)
# Generate using: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
FLASK_SECRET_KEY=REPLACE_WITH_SECURE_32_CHAR_SECRET_KEY

# Generate using: python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
PLATFORM_ENCRYPTION_KEY=REPLACE_WITH_SECURE_FERNET_ENCRYPTION_KEY

# =============================================================================
# PRODUCTION MYSQL CONFIGURATION
# =============================================================================

# Production MySQL Setup with SSL
DB_TYPE=mysql
DB_NAME=vedfolnir
DB_USER=vedfolnir_prod
DB_PASSWORD=REPLACE_WITH_SECURE_MYSQL_PASSWORD
DB_HOST=mysql.production.example.com
DB_PORT=3306

# Production Database URL with SSL
DATABASE_URL=mysql+pymysql://vedfolnir_prod:SECURE_PASSWORD@mysql.production.example.com:3306/vedfolnir?charset=utf8mb4&ssl_disabled=false&ssl_verify_cert=true&ssl_verify_identity=true

# Production Connection Pool (optimized for high load)
DB_POOL_SIZE=50
DB_MAX_OVERFLOW=100
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true
DB_QUERY_LOGGING=false                   # Disable query logging in production

# MySQL Production Settings
MYSQL_SSL_ENABLED=true                   # SSL required for production
MYSQL_SSL_REQUIRED=true
MYSQL_SSL_VERIFY_CERT=true
MYSQL_SSL_VERIFY_IDENTITY=true
MYSQL_SSL_CA=/etc/ssl/mysql/ca.pem
MYSQL_SSL_CERT=/etc/ssl/mysql/client-cert.pem
MYSQL_SSL_KEY=/etc/ssl/mysql/client-key.pem

MYSQL_CHARSET=utf8mb4
MYSQL_COLLATION=utf8mb4_unicode_ci
MYSQL_ENGINE=InnoDB

# MySQL Performance Settings
MYSQL_QUERY_CACHE_ENABLED=true
MYSQL_QUERY_CACHE_SIZE=5000
MYSQL_QUERY_CACHE_TTL=600
MYSQL_BATCH_SIZE=500
MYSQL_MAX_BATCH_SIZE=2000

# =============================================================================
# PRODUCTION REDIS CONFIGURATION
# =============================================================================

# Production Redis Setup with SSL and Authentication
REDIS_URL=redis://:SECURE_REDIS_PASSWORD@redis.production.example.com:6380/0
REDIS_HOST=redis.production.example.com
REDIS_PORT=6380
REDIS_DB=0
REDIS_PASSWORD=REPLACE_WITH_SECURE_REDIS_PASSWORD
REDIS_SSL=true

# Redis SSL Configuration
REDIS_SSL_CERT_REQS=required
REDIS_SSL_CA_CERTS=/etc/ssl/redis/ca.pem
REDIS_SSL_CERTFILE=/etc/ssl/redis/client.pem
REDIS_SSL_KEYFILE=/etc/ssl/redis/client-key.pem

# Production Session Settings
REDIS_SESSION_PREFIX=vedfolnir_prod:session:
REDIS_SESSION_TIMEOUT=7200
SESSION_COOKIE_SECURE=true              # Require HTTPS cookies in production
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Strict

# Redis Connection Pool (production optimized)
REDIS_POOL_MAX_CONNECTIONS=100
REDIS_POOL_RETRY_ON_TIMEOUT=true
REDIS_SOCKET_KEEPALIVE=true

# =============================================================================
# PRODUCTION LOGGING AND MONITORING
# =============================================================================

# Production Logging (minimal verbosity)
LOG_LEVEL=WARNING
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_MAX_BYTES=52428800                   # 50MB log files
LOG_BACKUP_COUNT=10                      # Keep 10 backup files

# Production-specific Logging
MYSQL_LOG_QUERIES=false                  # Disable query logging
MYSQL_LOG_SLOW_QUERIES=true             # Log only slow queries
MYSQL_LOG_CONNECTION_EVENTS=false
REDIS_LOG_COMMANDS=false

# Debug Features (disabled in production)
DEBUG_TOOLBAR_ENABLED=false
PROFILING_ENABLED=false
DEVELOPMENT_MODE=false

# =============================================================================
# PRODUCTION AI/ML CONFIGURATION
# =============================================================================

# Production Ollama Setup
OLLAMA_URL=http://ollama.production.example.com:11434
OLLAMA_MODEL=llava:13b                   # Larger model for better quality
OLLAMA_TIMEOUT=60.0
OLLAMA_MAX_CONCURRENT_REQUESTS=10       # Higher concurrency for production

# Production Caption Settings
CAPTION_MAX_LENGTH=500
DRY_RUN=false                           # Disable dry run in production
MAX_POSTS_PER_RUN=50                    # Larger batches for efficiency
USER_PROCESSING_DELAY=5                 # Respect rate limits
MAX_USERS_PER_RUN=20

# =============================================================================
# PRODUCTION SECURITY SETTINGS
# =============================================================================

# Full Security Enabled
SECURITY_CSRF_ENABLED=true
SECURITY_RATE_LIMITING_ENABLED=true
SECURITY_INPUT_VALIDATION_ENABLED=true
SECURITY_HEADERS_ENABLED=true
SECURITY_SESSION_VALIDATION_ENABLED=true
SECURITY_ADMIN_CHECKS_ENABLED=true

# Production Authentication
AUTH_REQUIRE_AUTH=true
AUTH_SESSION_LIFETIME=28800             # 8 hours for production
AUTH_REMEMBER_COOKIE_DURATION=604800    # 7 days

# Password Security (strict requirements)
PASSWORD_MIN_LENGTH=16
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true
PASSWORD_HASH_ROUNDS=14                 # Higher rounds for production

# Security Features
SECURITY_ENCRYPTION_ALGORITHM=Fernet
SECURITY_KEY_ROTATION_ENABLED=true
SECURITY_KEY_ROTATION_INTERVAL=2592000  # 30 days

# MySQL Security
MYSQL_ENCRYPT_CREDENTIALS=true
MYSQL_VALIDATE_SERVER_CERT=true

# =============================================================================
# PRODUCTION RATE LIMITING
# =============================================================================

# Strict Rate Limiting for Production
RATE_LIMIT_REQUESTS_PER_MINUTE=30
RATE_LIMIT_REQUESTS_PER_HOUR=500
RATE_LIMIT_REQUESTS_PER_DAY=5000
RATE_LIMIT_MAX_BURST=5

# Endpoint-specific limits (conservative)
RATE_LIMIT_ENDPOINT_MEDIA_MINUTE=10
RATE_LIMIT_ENDPOINT_MEDIA_HOUR=100
RATE_LIMIT_ENDPOINT_STATUSES_MINUTE=20
RATE_LIMIT_ENDPOINT_STATUSES_HOUR=200

# =============================================================================
# PRODUCTION MONITORING AND HEALTH CHECKS
# =============================================================================

# Comprehensive Health Checks
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=60
HEALTH_CHECK_TIMEOUT=10

# Component Health Checks
HEALTH_CHECK_MYSQL=true
HEALTH_CHECK_REDIS=true
HEALTH_CHECK_OLLAMA=true
HEALTH_CHECK_DISK_SPACE=true

# Production Health Thresholds
HEALTH_CHECK_MYSQL_MAX_CONNECTIONS=70   # Conservative threshold
HEALTH_CHECK_REDIS_MEMORY_THRESHOLD=75
HEALTH_CHECK_DISK_SPACE_THRESHOLD=80

# Metrics and Monitoring
METRICS_ENABLED=true
METRICS_INTERVAL=60
METRICS_RETENTION_DAYS=90

# Performance Monitoring
MYSQL_PERFORMANCE_MONITORING=true
MYSQL_SLOW_QUERY_THRESHOLD=1.0         # Log queries slower than 1 second
MYSQL_CONNECTION_MONITORING=true

# =============================================================================
# PRODUCTION OPTIMIZATION
# =============================================================================

# Production Mode
PRODUCTION_MODE=true
OPTIMIZE_FOR_PRODUCTION=true

# Caching (aggressive caching for production)
CACHE_ENABLED=true
CACHE_TYPE=redis
CACHE_DEFAULT_TIMEOUT=600               # 10 minutes
CACHE_KEY_PREFIX=vedfolnir_prod_cache_

# Performance Features
ENABLE_GZIP_COMPRESSION=true
STATIC_FILE_CACHING=true
TEMPLATE_CACHING=true

# Resource Limits (production appropriate)
MAX_CONTENT_LENGTH=33554432             # 32MB for production
MAX_FORM_MEMORY_SIZE=4194304           # 4MB form memory

# =============================================================================
# PRODUCTION STORAGE AND RETENTION
# =============================================================================

# Production Storage Paths
STORAGE_BASE_DIR=/var/lib/vedfolnir/storage
STORAGE_IMAGES_DIR=/var/lib/vedfolnir/storage/images
LOGS_DIR=/var/log/vedfolnir
MYSQL_BACKUP_DIR=/var/lib/vedfolnir/backups/mysql

# Production Retention Policies
RETENTION_PROCESSING_RUNS=180           # 6 months
RETENTION_REJECTED_IMAGES=30            # 30 days
RETENTION_POSTED_IMAGES=365             # 1 year
RETENTION_ERROR_IMAGES=90               # 90 days
RETENTION_MYSQL_BACKUPS=90              # 90 days
RETENTION_MYSQL_LOGS=30                 # 30 days

# =============================================================================
# PRODUCTION EMAIL CONFIGURATION
# =============================================================================

# Production Email Settings
MAIL_SERVER=smtp.production.example.com
MAIL_PORT=587
MAIL_USE_TLS=true
MAIL_USE_SSL=false
MAIL_USERNAME=vedfolnir@production.example.com
MAIL_PASSWORD=REPLACE_WITH_SECURE_EMAIL_PASSWORD
MAIL_DEFAULT_SENDER=noreply@production.example.com

# Email Security
MAIL_SUPPRESS_SEND=false
MAIL_ASCII_ATTACHMENTS=true

# =============================================================================
# PRODUCTION SESSION MANAGEMENT
# =============================================================================

# Production Session Configuration
SESSION_ENVIRONMENT=production
SESSION_DEBUG_MODE=false

# Session Timeouts (production appropriate)
SESSION_LIFETIME_SECONDS=28800          # 8 hours
SESSION_IDLE_TIMEOUT_SECONDS=3600       # 1 hour idle timeout
SESSION_ABSOLUTE_TIMEOUT_SECONDS=86400  # 24 hours absolute
SESSION_EXPIRATION_GRACE_SECONDS=300    # 5 minutes grace

# Session Security (strict)
SESSION_ENABLE_FINGERPRINTING=true
SESSION_ENABLE_SUSPICIOUS_DETECTION=true
SESSION_ENABLE_AUDIT_LOGGING=true
SESSION_MAX_CONCURRENT_PER_USER=3       # Limit concurrent sessions
SESSION_SUSPICIOUS_ACTIVITY_THRESHOLD=5
SESSION_MAX_PLATFORM_SWITCHES_PER_HOUR=20

# Session Monitoring
SESSION_ENABLE_PERFORMANCE_MONITORING=true
SESSION_ENABLE_METRICS_COLLECTION=true
SESSION_ENABLE_HEALTH_CHECKS=true

# =============================================================================
# PRODUCTION DEPLOYMENT NOTES
# =============================================================================

# PRODUCTION DEPLOYMENT CHECKLIST:
# □ Replace ALL example passwords and keys with secure values
# □ Configure SSL certificates for MySQL and Redis
# □ Set up proper firewall rules
# □ Configure log rotation and monitoring
# □ Set up automated backups
# □ Configure health check endpoints
# □ Set up monitoring and alerting
# □ Test disaster recovery procedures
# □ Configure rate limiting and DDoS protection
# □ Set up SSL/TLS termination at load balancer
# □ Configure proper DNS and CDN
# □ Set up automated security updates

# SECURITY REQUIREMENTS:
# - All connections must use SSL/TLS encryption
# - Strong passwords and key rotation policies
# - Regular security audits and penetration testing
# - Comprehensive logging and monitoring
# - Automated backup and disaster recovery
# - Network segmentation and firewall protection
# - Regular dependency updates and security patches

# MONITORING REQUIREMENTS:
# - Application performance monitoring (APM)
# - Database performance monitoring
# - Infrastructure monitoring (CPU, memory, disk, network)
# - Log aggregation and analysis
# - Security event monitoring
# - Automated alerting for critical issues
# - Regular health checks and uptime monitoring
