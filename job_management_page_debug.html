<!-- Copyright (C) 2025 iolaire mcfadden. -->
<!-- This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. -->
<!-- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. -->

<!DOCTYPE html>
<!-- Copyright (C) 2025 iolaire mcfadden. -->
<!-- This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. -->
<!-- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. -->

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="ImJlNzI0ZTZkMWU4YjY4OWE5MDU2YjAyMDBjZTc5ZWYwYzlhM2I1NzMi.aMgM6g.PO_Cri26linRF1gJ8JXC6LIVv5c">
    
    <!-- Security Headers (Note: Security headers are set via HTTP headers in SecurityMiddleware) -->
    <!-- Keeping only CSRF token meta tag for JavaScript access -->
    <title>Login - Vedfolnir</title>
    
    <!-- Performance Optimizations -->
    
        <!-- Fallback Preconnect -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    
    <!-- Critical CSS for Above-the-Fold Content -->
    
    
    <!-- Modern font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Bootstrap and icons with fallback -->
    <link href="/static/css/bootstrap-fallback.css?v=1.0.0" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- CSS Variables (must be loaded first) -->
    <link href="/static/css/css-variables.css?v=1.0.0" rel="stylesheet">
    
    <!-- Utilities (foundational classes) -->
    <link href="/static/css/utilities.css?v=1.0.0" rel="stylesheet">
    
    <!-- Custom styles -->
    <link href="/static/css/style.css?v=1.0.0" rel="stylesheet">
    <link href="/static/css/components.css?v=1.0.0" rel="stylesheet">
    <link href="/static/css/security-extracted.css?v=1.0.0" rel="stylesheet">
    <link href="/static/css/platform_styles.css?v=1.0.0" rel="stylesheet">
    <link href="/static/css/fixes.css?v=1.0.0" rel="stylesheet">
    
    <!-- Unified Notification System Styles -->
    <link href="/static/css/unified-notifications.css?v=1.0.0" rel="stylesheet">
    <link href="/static/css/notification-ui.css?v=1.0.0" rel="stylesheet">
    <link href="/static/css/legacy-notification-fallback.css?v=1.0.0" rel="stylesheet">
    
    <!-- Session Management Styles -->
    <style nonce="Lsd7o3upAjmahJmGS6H7WQ">
        .session-status-indicator {
            display: inline-block;
            margin-left: 0.5rem;
            font-size: 0.75rem;
        }
        
        .session-status-indicator i {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .platform-switch-item:hover {
            background-color: var(--bs-dropdown-link-hover-bg);
        }
        
        .dropdown-item-text {
            padding: 0.25rem 1rem;
            margin-bottom: 0;
            font-size: 0.875rem;
            color: var(--bs-dropdown-color);
            text-decoration: none;
            white-space: nowrap;
            background-color: transparent;
            border: 0;
        }
    </style>
    
    <!-- Favicon -->
    <!-- Copyright (C) 2025 iolaire mcfadden. -->
<!-- This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. -->
<!-- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. -->
<!-- Standard favicon -->
<link rel="icon" type="image/x-icon" href="/static/favicons/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/static/favicons/favicon-96x96.png">

<!-- Apple Touch Icons -->
<link rel="apple-touch-icon" sizes="57x57" href="/static/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/static/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/static/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/static/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/static/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/static/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/static/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/static/favicons/apple-icon-180x180.png">

<!-- Android Chrome Icons -->
<link rel="icon" type="image/png" sizes="36x36" href="/static/favicons/android-icon-36x36.png">
<link rel="icon" type="image/png" sizes="48x48" href="/static/favicons/android-icon-48x48.png">
<link rel="icon" type="image/png" sizes="72x72" href="/static/favicons/android-icon-72x72.png">
<link rel="icon" type="image/png" sizes="96x96" href="/static/favicons/android-icon-96x96.png">
<link rel="icon" type="image/png" sizes="144x144" href="/static/favicons/android-icon-144x144.png">
<link rel="icon" type="image/png" sizes="192x192" href="/static/favicons/android-icon-192x192.png">

<!-- PWA Manifest -->
<link rel="manifest" href="/static/favicons/manifest.json">

<!-- Windows Tiles -->
<meta name="msapplication-config" content="/static/favicons/browserconfig.xml">
<meta name="msapplication-TileColor" content="#212529">
<meta name="msapplication-TileImage" content="/static/favicons/ms-icon-144x144.png">

<!-- Theme colors -->
<meta name="theme-color" content="#212529">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Vedfolnir">
    
    
</head>
<body data-authenticated="false">
    <!-- Skip to content link for accessibility -->
    <a href="#page-content" class="skip-to-content">Skip to main content</a>
    
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="/landing" aria-label="Vedfolnir - Go to landing page">
                <img src="/static/images/Logo.png?v=1.0.0" 
                     alt="Vedfolnir Logo - AI-Powered Accessibility for the Fediverse" 
                     class="navbar-logo me-2"
                     height="32"
                     width="32"
                     class="logo-fallback"
                     role="img">
                <span class="navbar-brand-text">Vedfolnir</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    
                        <!-- Anonymous user navigation - minimal navigation items -->
                        <!-- No navigation items for anonymous users on landing page -->
                    
                </ul>
                <ul class="navbar-nav">
                    
                        <!-- Anonymous user navigation - Login link in top-right corner -->
                        <li class="nav-item">
                            <a class="nav-link" href="/user-management/login">
                                <i class="bi bi-box-arrow-in-right me-1"></i>Login
                            </a>
                        </li>
                    
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4" id="page-content">
        <!-- Unified Notification Container -->
        <div id="unified-notification-container" class="notification-container notification-position-top notification-position-right notification-stack-down" role="region" aria-label="Notifications" aria-live="polite"></div>
        
        <!-- Flash Message Integration with Unified System -->
        <!-- Unified Notification System Integration -->
<!-- Flash messages are now handled by the WebSocket-based notification system -->
<!-- See static/js/websocket-client-factory.js for notification handling -->

        
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-4">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0 text-center">
                        <i class="fas fa-sign-in-alt me-2"></i>Sign In
                    </h4>
                </div>
                <div class="card-body p-4">
                    <p class="text-muted text-center mb-4">
                        Welcome back to Vedfolnir
                    </p>

                    <form method="POST" novalidate>
                        <input type="hidden" name="csrf_token" value="ImJlNzI0ZTZkMWU4YjY4OWE5MDU2YjAyMDBjZTc5ZWYwYzlhM2I1NzMi.aMgM6g.PO_Cri26linRF1gJ8JXC6LIVv5c">
                        
                        <!-- Username or Email Field -->
                        <div class="mb-3">
                            <label class="form-label" for="username_or_email">Username or Email</label>
                            <input autocomplete="username" class="form-control" id="username_or_email" maxlength="120" name="username_or_email" placeholder="Enter your username or email" required type="text" value="">
                            
                        </div>

                        <!-- Password Field -->
                        <div class="mb-3">
                            <label class="form-label" for="password">Password</label>
                            <div class="input-group">
                                <input autocomplete="current-password" class="form-control" id="password" name="password" placeholder="Enter your password" required type="password" value="">
                                <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                    <i class="fas fa-eye" id="togglePasswordIcon"></i>
                                </button>
                            </div>
                            
                        </div>

                        <!-- Remember Me -->
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" id="remember_me" name="remember_me" type="checkbox" value="y">
                                <label class="form-check-label" for="remember_me">Remember me</label>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <div class="d-grid">
                            <input class="btn btn-primary btn-lg" id="submit" name="submit" type="submit" value="Login">
                        </div>
                    </form>

                    <!-- Additional Links -->
                    <div class="text-center mt-4">
                        <p class="text-muted mb-2">
                            <a href="/user-management/forgot-password" class="text-decoration-none">
                                Forgot your password?
                            </a>
                        </p>
                        <p class="text-muted">
                            Don't have an account? 
                            <a href="/user-management/register" class="text-decoration-none">Sign up here</a>
                        </p>
                        <p class="text-muted">
                            <a href="/landing" class="text-decoration-none">
                                <i class="fas fa-info-circle me-1"></i>Learn more about Vedfolnir
                            </a>
                        </p>
                    </div>

                    <!-- Email Verification Notice -->
                    <!-- Unified Notification System Integration -->
<!-- Flash messages are now handled by the WebSocket-based notification system -->
<!-- See static/js/websocket-client-factory.js for notification handling -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Password Toggle Script -->
<script nonce="Lsd7o3upAjmahJmGS6H7WQ">
document.addEventListener('DOMContentLoaded', function() {
    const toggle = document.getElementById('togglePassword');
    const password = document.getElementById('password');
    const icon = document.getElementById('togglePasswordIcon');
    
    if (toggle && password && icon) {
        toggle.addEventListener('click', function() {
            const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
            password.setAttribute('type', type);
            
            if (type === 'text') {
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        });
    }
});
</script>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js" crossorigin="anonymous"></script>
    <script src="/static/js/csrf-handler.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    <script src="/static/js/progress-bar-utils.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    <!-- WebSocket Transport Optimizer -->
    <script src="/static/js/websocket-transport-optimizer.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    <script src="/static/js/websocket-bundle.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    
    <!-- Unified Notification System Scripts -->
    <!-- Unified Notification System -->
    <script src="/static/js/notification-ui-renderer.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    <script src="/static/js/page_notification_integrator.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    
    <script src="/static/js/app.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    <script src="/static/js/error_handler.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    <script src="/static/js/session-sync.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    <script src="/static/js/navigation.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    <script src="/static/js/platform_context_refresh.js?v=1.0.0" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
    
    <!-- Session Management JavaScript -->
    <script nonce="Lsd7o3upAjmahJmGS6H7WQ">
        // Handle logout with session sync
        function handleLogout(event) {
            if (window.sessionSync) {
                window.sessionSync.broadcastLogout();
            }
            // Let the default action proceed
            return true;
        }
        
        // Handle logout all devices
        function handleLogoutAll(event) {
            if (window.sessionSync) {
                window.sessionSync.broadcastLogout();
            }
            // Let the default action proceed
            return true;
        }
        
        // Update session status indicator
        function updateSessionStatus(isActive) {
            const indicator = document.getElementById('sessionStatusIndicator');
            if (indicator) {
                const icon = indicator.querySelector('i');
                if (isActive) {
                    icon.className = 'bi bi-circle-fill text-success';
                    indicator.title = 'Session Active';
                } else {
                    icon.className = 'bi bi-circle-fill text-warning';
                    indicator.title = 'Session Issues';
                }
            }
        }
        
        // Listen for session state changes
        window.addEventListener('sessionStateChanged', function(event) {
            updateSessionStatus(true);
        });
        
        window.addEventListener('sessionExpired', function(event) {
            updateSessionStatus(false);
        });
        
        // Quick platform switching function
        window.quickSwitchPlatform = async function(platformId, platformName) {
            try {
                // Show loading state
                const switchItems = document.querySelectorAll('.platform-switch-item');
                switchItems.forEach(item => {
                    item.style.opacity = '0.6';
                    item.style.pointerEvents = 'none';
                });
                
                // Use secure fetch with automatic CSRF handling
                const response = await window.csrfHandler.secureFetch(`/api/switch_platform/${platformId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Notify session sync about the platform switch
                    if (window.sessionSync) {
                        window.sessionSync.notifyPlatformSwitch(platformId, platformName);
                    }
                    
                    // Update UI immediately
                    if (result.platform) {
                        updatePlatformUI(result.platform);
                    }
                    
                    // Show success message
                    if (window.errorHandler) {
                        window.errorHandler.showNotification(result.message, 'success');
                    }
                    
                    // Refresh the page after a short delay to ensure all components are updated
                    setTimeout(() => {
                        window.location.reload();
                    }, 1000);
                } else {
                    throw new Error(result.error || 'Failed to switch platform');
                }
            } catch (error) {
                console.error('Error switching platform:', error);
                
                if (window.errorHandler) {
                    window.errorHandler.showNotification('Failed to switch platform: ' + error.message, 'danger');
                } else {
                    alert('Failed to switch platform: ' + error.message);
                }
            } finally {
                // Restore UI state
                const switchItems = document.querySelectorAll('.platform-switch-item');
                switchItems.forEach(item => {
                    item.style.opacity = '';
                    item.style.pointerEvents = '';
                });
            }
        };
        
        // Update platform UI elements
        function updatePlatformUI(platform) {
            // Update platform dropdown text
            const platformDropdown = document.getElementById('platformsDropdown');
            if (platformDropdown) {
                platformDropdown.textContent = `Platforms: ${platform.name}`;
            }
            
            // Update current platform displays
            const currentPlatformElements = document.querySelectorAll('[data-current-platform]');
            currentPlatformElements.forEach(element => {
                element.textContent = platform.name;
                element.setAttribute('data-platform-id', platform.id);
                element.setAttribute('data-platform-type', platform.platform_type);
            });
        }
        
        // Fallback for Bootstrap JS functionality
        if (typeof bootstrap === 'undefined') {
            document.addEventListener('click', function(e) {
                if (e.target.matches('[data-bs-toggle="dropdown"]')) {
                    e.preventDefault();
                    const menu = e.target.nextElementSibling;
                    if (menu && menu.classList.contains('dropdown-menu')) {
                        menu.classList.toggle('show');
                    }
                }
                // Close dropdowns when clicking outside
                document.querySelectorAll('.dropdown-menu.show').forEach(menu => {
                    if (!menu.parentElement.contains(e.target)) {
                        menu.classList.remove('show');
                    }
                });
            });
        }
        
        // Session management functions
        function handleLogout(event) {
            // Notify other tabs about logout
            if (window.vedfolnir && window.vedfolnir.sessionSync) {
                window.vedfolnir.sessionSync.notifyLogout();
            }
            
            // Allow normal logout to proceed
            return true;
        }
        
        // Platform switching handler
        function handlePlatformSwitch(platformId, platformName) {
            // Notify other tabs about platform switch
            if (window.vedfolnir && window.vedfolnir.sessionSync) {
                window.vedfolnir.sessionSync.notifyPlatformSwitch({
                    id: platformId,
                    name: platformName
                });
            }
        }
    </script>
    
    <!-- Unified Notification System Initialization -->
    <script nonce="Lsd7o3upAjmahJmGS6H7WQ">
    // Function to check and display anonymous user notifications
    function checkAndDisplayAnonymousNotifications() {
        // Check if we're on a page that might have anonymous notifications
        const currentPath = window.location.pathname;
        const authPaths = ['/user-management/login', '/user-management/register', '/user-management/forgot-password', '/user-management/verify-email'];
        
        if (authPaths.includes(currentPath) || currentPath.startsWith('/user-management/verify-email/')) {
            // Fetch anonymous notifications from the server
            fetch('/user-management/get-anonymous-notifications', {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('meta[name="csrf-token"]')?.getAttribute('content') || ''
                },
                credentials: 'same-origin'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success && data.notifications && data.notifications.length > 0) {
                    // Display each notification using the unified notification system
                    data.notifications.forEach(notification => {
                        if (window.unifiedNotificationRenderer && window.unifiedNotificationRenderer.renderNotification) {
                            window.unifiedNotificationRenderer.renderNotification(notification);
                        } else {
                            // Fallback to alert if notification system not available
                            alert(`${notification.title}: ${notification.message}`);
                        }
                    });
                }
            })
            .catch(error => {
                console.warn('Error fetching anonymous notifications:', error);
            });
        }
    }

    // Initialize unified notification system
    document.addEventListener('DOMContentLoaded', function() {
        // Check for and display anonymous user notifications
        checkAndDisplayAnonymousNotifications();
        
        // Initialize main notification renderer if not already initialized
        if (!window.unifiedNotificationRenderer && typeof NotificationUIRenderer !== 'undefined') {
            try {
                window.unifiedNotificationRenderer = new NotificationUIRenderer('unified-notification-container', {
                    position: 'top-right',
                    maxNotifications: 5,
                    autoHide: true,
                    defaultDuration: 5000,
                    theme: 'modern',
                    showIcons: true,
                    allowDismiss: true,
                    pauseOnHover: true
                });
                console.log('Unified notification system initialized successfully');
            } catch (error) {
                console.warn('Failed to initialize unified notification system:', error);
                // Fallback to basic notification system
                window.unifiedNotificationRenderer = {
                    renderNotification: function(notification) {
                        console.log('Notification (fallback):', notification);
                        alert(notification.message || 'Notification received');
                    }
                };
            }
        } else if (typeof NotificationUIRenderer === 'undefined') {
            console.warn('NotificationUIRenderer not available - notification system disabled');
            // Create a fallback notification handler
            window.unifiedNotificationRenderer = {
                renderNotification: function(notification) {
                    console.log('Notification (fallback):', notification);
                    if (notification.message && typeof notification.message === 'string') {
                        alert(notification.message);
                    }
                }
            };
        }
        
        // Global notification functions
        window.showNotification = function(message, type = 'info', title = null, options = {}) {
            return window.unifiedNotificationRenderer.renderNotification({
                type: type,
                title: title || (type === 'error' ? 'Error' : type === 'success' ? 'Success' : type === 'warning' ? 'Warning' : 'Information'),
                message: message,
                priority: type === 'error' ? 'high' : 'normal',
                ...options
            });
        };
        
        window.showSystemAlert = function(message, type = 'warning', persistent = false) {
            return window.unifiedNotificationRenderer.renderSystemAlert({
                type: type,
                title: 'System Alert',
                message: message,
                persistent: persistent,
                priority: 'critical'
            });
        };
        
        window.showProgress = function(taskId, message, percentage = 0) {
            return window.unifiedNotificationRenderer.renderProgressUpdate({
                id: `progress-${taskId}`,
                taskId: taskId,
                title: 'Processing...',
                message: message,
                percentage: percentage
            });
        };
        
        // Fallback notification function for legacy compatibility
        window.showFallbackNotification = function(message, type = 'info', duration = 5000) {
            return window.showNotification(message, type, null, { duration: duration });
        };
        
        console.log('Unified notification system initialized');
    });
    </script>
    
    

    <!-- CSP-Compliant Scripts -->
    <link rel="stylesheet" href="/static/css/csp-compliant-styles.css?v=1.0.1">
    <script src="/static/js/csp-compliant-handlers.js?v=1.0.1" nonce="Lsd7o3upAjmahJmGS6H7WQ"></script>
</body>
</html>