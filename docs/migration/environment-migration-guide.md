# Environment Configuration Migration Guide\n\n## Overview\n\nThis guide helps you migrate from the old environment configuration to the new\nclean configuration structure where platform credentials are stored securely\nin the database.\n\n## Changes Made\n\n### Deprecated Settings Removed\n\nThe following platform-specific settings have been removed from .env files\nand are now managed through the web interface:\n\n- `ACTIVITYPUB_INSTANCE_URL` → Database: `PlatformConnection.instance_url`\n- `ACTIVITYPUB_ACCESS_TOKEN` → Database: `PlatformConnection.access_token` (encrypted)\n- `ACTIVITYPUB_USERNAME` → Database: `PlatformConnection.username`\n- `MASTODON_CLIENT_KEY` → Database: `PlatformConnection.client_key` (encrypted)\n- `MASTODON_CLIENT_SECRET` → Database: `PlatformConnection.client_secret` (encrypted)\n- `ACTIVITYPUB_API_TYPE` → Database: `PlatformConnection.platform_type`\n\n### Migration Steps\n\n1. **Note Your Current Credentials**: Before cleanup, note down your platform credentials from the old .env file\n\n2. **Start the Web Application**: \n   ```bash\n   python web_app.py\n   ```\n\n3. **Access Platform Management**: Go to http://localhost:5000 and navigate to Platform Management\n\n4. **Add Platform Connection**: \n   - Click \"Add Platform\"\n   - Select your platform type (Pixelfed or Mastodon)\n   - Enter your instance URL\n   - Enter your username\n   - Enter your access token\n   - For Mastodon: Also enter client key and secret\n   - Test the connection\n   - Save the configuration\n\n5. **Verify Configuration**: Test caption generation to ensure the platform connection works\n\n6. **Remove Old Backups**: Once confirmed working, you can remove the backup files\n\n## Security Benefits\n\n- **Encrypted Storage**: Platform credentials are now encrypted in the database\n- **Web Management**: Easy credential management through secure web interface\n- **No Plain Text**: No sensitive credentials in environment files\n- **Access Control**: Platform management requires authentication\n\n## Troubleshooting\n\nIf you encounter issues:\n\n1. Check that your platform credentials are correct\n2. Verify the platform connection through the web interface\n3. Check the application logs for detailed error messages\n4. Ensure the `PLATFORM_ENCRYPTION_KEY` is set in your .env file\n\nFor additional help, refer to the main documentation or check the backup files\nin `scripts/setup/` for your old configuration.