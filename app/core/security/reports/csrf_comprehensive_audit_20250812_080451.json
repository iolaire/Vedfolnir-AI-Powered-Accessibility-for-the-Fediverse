{
  "report_metadata": {
    "report_type": "CSRF Security Audit",
    "generated_at": "2025-08-12T08:04:51.791405",
    "scan_timestamp": "2025-08-12T08:04:36.388046",
    "templates_scanned": 29,
    "report_version": "1.0"
  },
  "executive_summary": {
    "overall_risk_level": "HIGH",
    "protection_rate": 1.0,
    "average_compliance_score": 0.8189655172413793,
    "total_vulnerabilities": 27,
    "key_findings": [
      "15 high-severity CSRF vulnerabilities found"
    ],
    "immediate_actions_required": true,
    "templates_requiring_attention": 8
  },
  "compliance_analysis": {
    "overall_compliance_score": 0.8189655172413793,
    "compliance_target": 0.9,
    "templates_meeting_target": 20,
    "score_distribution": {
      "excellent": 0,
      "good": 1,
      "fair": 3,
      "poor": 5
    },
    "csrf_method_distribution": {
      "hidden_tag": 4,
      "csrf_token_direct": 8,
      "meta_only": 0,
      "none": 17,
      "error": 0
    },
    "compliance_trends": {
      "current_score": 0.8189655172413793,
      "target_score": 0.9,
      "improvement_needed": 0.08103448275862069
    },
    "compliance_gaps": [
      "8 templates below compliance threshold"
    ]
  },
  "vulnerability_analysis": {
    "total_vulnerabilities": 27,
    "severity_distribution": {
      "HIGH": 15,
      "MEDIUM": 9,
      "LOW": 3
    },
    "vulnerability_types": {
      "exposed_csrf_token": {
        "count": 15,
        "severity_distribution": {
          "HIGH": 15
        },
        "affected_templates": [
          "templates/admin_cleanup.html",
          "templates/base.html",
          "templates/batch_review.html",
          "templates/components/add_platform_modal.html",
          "templates/review_batch.html",
          "templates/review_batches.html",
          "templates/review_single.html",
          "templates/user_management.html"
        ],
        "description": "CSRF token is visible in HTML output instead of being in a hidden field",
        "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
      },
      "csrf_in_comment": {
        "count": 7,
        "severity_distribution": {
          "MEDIUM": 7
        },
        "affected_templates": [
          "templates/base.html",
          "templates/batch_review.html",
          "templates/platform_management.html",
          "templates/review_batch.html",
          "templates/review_batches.html",
          "templates/review_single.html",
          "templates/user_management.html"
        ],
        "description": "CSRF token or reference found in HTML comment",
        "recommendation": "Remove CSRF references from HTML comments"
      },
      "unnecessary_csrf_token": {
        "count": 3,
        "severity_distribution": {
          "LOW": 3
        },
        "affected_templates": [
          "templates/batch_review.html",
          "templates/review_batch.html",
          "templates/review_batches.html"
        ],
        "description": "CSRF token found in GET form (unnecessary)",
        "recommendation": "Remove CSRF token from GET forms as they should be idempotent"
      },
      "csrf_in_visible_script": {
        "count": 2,
        "severity_distribution": {
          "MEDIUM": 2
        },
        "affected_templates": [
          "templates/batch_review.html",
          "templates/review_single.html"
        ],
        "description": "CSRF token directly embedded in visible JavaScript",
        "recommendation": "Use meta tag and document.querySelector for CSRF token access"
      }
    },
    "risk_score": 40.5,
    "most_common_vulnerabilities": [
      [
        "exposed_csrf_token",
        15
      ],
      [
        "csrf_in_comment",
        7
      ],
      [
        "unnecessary_csrf_token",
        3
      ],
      [
        "csrf_in_visible_script",
        2
      ]
    ],
    "vulnerability_trends": {
      "trend_analysis": "Historical data needed for trend analysis",
      "current_snapshot": {
        "templates_with_vulnerabilities": 9,
        "average_vulnerabilities_per_template": 0.9310344827586207
      }
    },
    "remediation_priority": [
      {
        "vulnerability_type": "exposed_csrf_token",
        "priority": "HIGH",
        "count": 15,
        "affected_templates": 8
      },
      {
        "vulnerability_type": "csrf_in_comment",
        "priority": "MEDIUM",
        "count": 7,
        "affected_templates": 7
      },
      {
        "vulnerability_type": "unnecessary_csrf_token",
        "priority": "MEDIUM",
        "count": 3,
        "affected_templates": 3
      },
      {
        "vulnerability_type": "csrf_in_visible_script",
        "priority": "MEDIUM",
        "count": 2,
        "affected_templates": 2
      }
    ]
  },
  "template_analysis": {
    "total_templates_analyzed": 29,
    "problematic_templates": [
      {
        "template_path": "templates/admin_cleanup.html",
        "compliance_score": 0.0,
        "vulnerability_count": 6,
        "csrf_method": "csrf_token_direct",
        "form_count": 6,
        "post_form_count": 6
      },
      {
        "template_path": "templates/user_management.html",
        "compliance_score": 0.10000000000000003,
        "vulnerability_count": 4,
        "csrf_method": "csrf_token_direct",
        "form_count": 3,
        "post_form_count": 3
      },
      {
        "template_path": "templates/batch_review.html",
        "compliance_score": 0.35000000000000003,
        "vulnerability_count": 4,
        "csrf_method": "csrf_token_direct",
        "form_count": 1,
        "post_form_count": 0
      },
      {
        "template_path": "templates/review_batch.html",
        "compliance_score": 0.45,
        "vulnerability_count": 3,
        "csrf_method": "csrf_token_direct",
        "form_count": 1,
        "post_form_count": 0
      },
      {
        "template_path": "templates/review_batches.html",
        "compliance_score": 0.45,
        "vulnerability_count": 3,
        "csrf_method": "csrf_token_direct",
        "form_count": 1,
        "post_form_count": 0
      },
      {
        "template_path": "templates/base.html",
        "compliance_score": 0.5,
        "vulnerability_count": 2,
        "csrf_method": "csrf_token_direct",
        "form_count": 0,
        "post_form_count": 0
      },
      {
        "template_path": "templates/components/add_platform_modal.html",
        "compliance_score": 0.6000000000000001,
        "vulnerability_count": 1,
        "csrf_method": "csrf_token_direct",
        "form_count": 1,
        "post_form_count": 0
      },
      {
        "template_path": "templates/review_single.html",
        "compliance_score": 0.6000000000000001,
        "vulnerability_count": 3,
        "csrf_method": "hidden_tag",
        "form_count": 1,
        "post_form_count": 1
      },
      {
        "template_path": "templates/platform_management.html",
        "compliance_score": 0.7,
        "vulnerability_count": 1,
        "csrf_method": "csrf_token_direct",
        "form_count": 1,
        "post_form_count": 0
      },
      {
        "template_path": "templates/404.html",
        "compliance_score": 1.0,
        "vulnerability_count": 0,
        "csrf_method": "none",
        "form_count": 0,
        "post_form_count": 0
      }
    ],
    "best_practice_templates": [
      {
        "template_path": "templates/404.html",
        "compliance_score": 1.0,
        "csrf_method": "none"
      },
      {
        "template_path": "templates/500.html",
        "compliance_score": 1.0,
        "csrf_method": "none"
      },
      {
        "template_path": "templates/admin/session_monitoring_dashboard.html",
        "compliance_score": 1.0,
        "csrf_method": "none"
      },
      {
        "template_path": "templates/admin_monitoring.html",
        "compliance_score": 1.0,
        "csrf_method": "none"
      },
      {
        "template_path": "templates/caption_generation.html",
        "compliance_score": 1.0,
        "csrf_method": "hidden_tag"
      }
    ],
    "template_categories": {
      "admin_templates": {
        "count": 3,
        "average_compliance": 0.6666666666666666,
        "vulnerability_count": 6
      },
      "form_templates": {
        "count": 6,
        "average_compliance": 0.6166666666666667,
        "vulnerability_count": 13
      },
      "ajax_templates": {
        "count": 4,
        "average_compliance": 1.0,
        "vulnerability_count": 0
      },
      "public_templates": {
        "count": 1,
        "average_compliance": 1.0,
        "vulnerability_count": 0
      }
    },
    "form_analysis": {
      "total_forms": 19,
      "post_forms": 13,
      "get_forms": 6,
      "templates_with_forms": 12,
      "templates_with_post_forms": 6,
      "average_forms_per_template": 0.6551724137931034
    },
    "ajax_analysis": {
      "templates_with_ajax": 4,
      "total_ajax_endpoints": 8,
      "average_ajax_per_template": 0.27586206896551724,
      "ajax_usage_rate": 0.13793103448275862
    }
  },
  "remediation_plan": {
    "total_remediation_tasks": 9,
    "remediation_phases": {
      "immediate": [
        {
          "template_path": "templates/components/add_platform_modal.html",
          "priority": 9,
          "impact_level": "HIGH",
          "effort_level": "LOW",
          "vulnerabilities": 1,
          "current_score": 0.6000000000000001,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          ]
        },
        {
          "template_path": "templates/base.html",
          "priority": 6,
          "impact_level": "HIGH",
          "effort_level": "MEDIUM",
          "vulnerabilities": 2,
          "current_score": 0.5,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Remove CSRF references from HTML comments"
          ]
        },
        {
          "template_path": "templates/review_batch.html",
          "priority": 6,
          "impact_level": "HIGH",
          "effort_level": "MEDIUM",
          "vulnerabilities": 3,
          "current_score": 0.45,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Remove CSRF token from GET forms as they should be idempotent",
            "Remove CSRF references from HTML comments",
            "Verify GET forms are idempotent and do not change server state"
          ]
        },
        {
          "template_path": "templates/review_batches.html",
          "priority": 6,
          "impact_level": "HIGH",
          "effort_level": "MEDIUM",
          "vulnerabilities": 3,
          "current_score": 0.45,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Remove CSRF token from GET forms as they should be idempotent",
            "Remove CSRF references from HTML comments",
            "Verify GET forms are idempotent and do not change server state"
          ]
        },
        {
          "template_path": "templates/review_single.html",
          "priority": 6,
          "impact_level": "HIGH",
          "effort_level": "MEDIUM",
          "vulnerabilities": 3,
          "current_score": 0.6000000000000001,
          "target_score": 0.9,
          "specific_actions": [
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Remove CSRF references from HTML comments",
            "Use meta tag and document.querySelector for CSRF token access",
            "Ensure all POST forms validate CSRF tokens on the server side"
          ]
        },
        {
          "template_path": "templates/admin_cleanup.html",
          "priority": 3,
          "impact_level": "HIGH",
          "effort_level": "HIGH",
          "vulnerabilities": 6,
          "current_score": 0.0,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Ensure all POST forms validate CSRF tokens on the server side"
          ]
        },
        {
          "template_path": "templates/batch_review.html",
          "priority": 3,
          "impact_level": "HIGH",
          "effort_level": "HIGH",
          "vulnerabilities": 4,
          "current_score": 0.35000000000000003,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Remove CSRF token from GET forms as they should be idempotent",
            "Remove CSRF references from HTML comments",
            "Use meta tag and document.querySelector for CSRF token access",
            "Verify GET forms are idempotent and do not change server state"
          ]
        },
        {
          "template_path": "templates/user_management.html",
          "priority": 3,
          "impact_level": "HIGH",
          "effort_level": "HIGH",
          "vulnerabilities": 4,
          "current_score": 0.10000000000000003,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
            "Remove CSRF references from HTML comments",
            "Ensure all POST forms validate CSRF tokens on the server side"
          ]
        }
      ],
      "short_term": [],
      "long_term": [
        {
          "template_path": "templates/platform_management.html",
          "priority": 3,
          "impact_level": "LOW",
          "effort_level": "LOW",
          "vulnerabilities": 1,
          "current_score": 0.7,
          "target_score": 0.9,
          "specific_actions": [
            "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
            "Remove CSRF references from HTML comments"
          ]
        }
      ]
    },
    "estimated_effort": {
      "total_story_points": 38,
      "estimated_days": 19.0,
      "effort_by_level": {
        "LOW": 2,
        "MEDIUM": 4,
        "HIGH": 3
      }
    },
    "quick_wins": [
      {
        "template_path": "templates/components/add_platform_modal.html",
        "priority": 9,
        "impact_level": "HIGH",
        "effort_level": "LOW",
        "vulnerabilities": 1,
        "current_score": 0.6000000000000001,
        "target_score": 0.9,
        "specific_actions": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        ]
      }
    ],
    "implementation_timeline": {
      "immediate": "Week 1-2: Address critical and high-severity vulnerabilities",
      "short_term": "Week 3-6: Implement medium-priority fixes and improvements",
      "long_term": "Month 2-3: Complete remaining improvements and establish monitoring"
    }
  },
  "security_metrics": {
    "protection_coverage": {
      "total_templates": 29,
      "protected_templates": 29,
      "protection_rate": 1.0,
      "unprotected_templates": 0
    },
    "vulnerability_metrics": {
      "total_vulnerabilities": 27,
      "vulnerabilities_per_template": 0.9310344827586207,
      "critical_vulnerability_rate": 0.0,
      "high_vulnerability_rate": 0.5172413793103449
    },
    "compliance_metrics": {
      "average_compliance_score": 0.8189655172413793,
      "high_compliance_templates": 20,
      "compliance_rate": 0.6896551724137931,
      "compliance_gap": 0.08103448275862069
    },
    "form_security_metrics": {
      "total_forms": 19,
      "post_forms": 13,
      "get_forms": 6,
      "forms_per_template": 0.6551724137931034
    }
  },
  "recommendations": [
    {
      "priority": "MEDIUM",
      "category": "Implementation Standards",
      "title": "Standardize CSRF Token Implementation",
      "description": "Found 8 templates using { csrf_token() } directly, which exposes tokens in HTML.",
      "implementation": "Replace {{ csrf_token() }} with {{ form.hidden_tag() }}",
      "impact": "Improves security by hiding CSRF tokens from HTML source"
    },
    {
      "priority": "HIGH",
      "category": "CSRF Protection",
      "title": "Add CSRF Protection to Unprotected Templates",
      "description": "Found 17 templates with no CSRF protection.",
      "implementation": "Add appropriate CSRF protection based on template functionality",
      "impact": "Provides comprehensive CSRF protection across the application"
    }
  ],
  "appendix": {
    "detailed_template_results": [
      {
        "template_path": "templates/404.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.356820"
      },
      {
        "template_path": "templates/500.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.357308"
      },
      {
        "template_path": "templates/admin/session_monitoring_dashboard.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [
          "/admin/session-monitoring/alerts"
        ],
        "last_audited": "2025-08-12T08:04:36.358094"
      },
      {
        "template_path": "templates/admin_cleanup.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 123,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 146,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 176,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 206,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 224,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 262,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 0.0,
        "form_count": 6,
        "post_form_count": 6,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.359845"
      },
      {
        "template_path": "templates/admin_monitoring.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [
          "/api/admin/user_activity?days=7",
          "/api/admin/system_overview",
          "/api/admin/active_tasks",
          "/api/admin/cleanup_tasks"
        ],
        "last_audited": "2025-08-12T08:04:36.362168"
      },
      {
        "template_path": "templates/base.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 10,
            "code_snippet": "<meta name=\"csrf-token\" content=\"{{ csrf_token() }}\">",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "csrf_in_comment",
            "severity": "MEDIUM",
            "description": "CSRF token or reference found in HTML comment",
            "line_number": 2,
            "code_snippet": null,
            "recommendation": "Remove CSRF references from HTML comments"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Remove CSRF references from HTML comments"
        ],
        "compliance_score": 0.5,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.364240"
      },
      {
        "template_path": "templates/batch_review.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 99,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "unnecessary_csrf_token",
            "severity": "LOW",
            "description": "CSRF token found in GET form (unnecessary)",
            "line_number": 98,
            "code_snippet": null,
            "recommendation": "Remove CSRF token from GET forms as they should be idempotent"
          },
          {
            "type": "csrf_in_comment",
            "severity": "MEDIUM",
            "description": "CSRF token or reference found in HTML comment",
            "line_number": 1,
            "code_snippet": null,
            "recommendation": "Remove CSRF references from HTML comments"
          },
          {
            "type": "csrf_in_visible_script",
            "severity": "MEDIUM",
            "description": "CSRF token directly embedded in visible JavaScript",
            "line_number": 10,
            "code_snippet": null,
            "recommendation": "Use meta tag and document.querySelector for CSRF token access"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Remove CSRF token from GET forms as they should be idempotent",
          "Remove CSRF references from HTML comments",
          "Use meta tag and document.querySelector for CSRF token access",
          "Verify GET forms are idempotent and do not change server state"
        ],
        "compliance_score": 0.35000000000000003,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 1,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.365189"
      },
      {
        "template_path": "templates/caption_generation.html",
        "csrf_protected": true,
        "csrf_method": "hidden_tag",
        "vulnerabilities": [],
        "recommendations": [
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 1,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.367089"
      },
      {
        "template_path": "templates/caption_settings.html",
        "csrf_protected": true,
        "csrf_method": "hidden_tag",
        "vulnerabilities": [],
        "recommendations": [
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 1,
        "get_form_count": 0,
        "ajax_endpoints": [
          "/api/validate_caption_settings",
          "/api/caption_settings"
        ],
        "last_audited": "2025-08-12T08:04:36.368181"
      },
      {
        "template_path": "templates/components/add_platform_modal.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 14,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
        ],
        "compliance_score": 0.6000000000000001,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.369000"
      },
      {
        "template_path": "templates/errors/400.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.369709"
      },
      {
        "template_path": "templates/errors/401.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.370194"
      },
      {
        "template_path": "templates/errors/403.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.370528"
      },
      {
        "template_path": "templates/errors/404.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.370822"
      },
      {
        "template_path": "templates/errors/429.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.371120"
      },
      {
        "template_path": "templates/errors/500.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.371398"
      },
      {
        "template_path": "templates/errors/session_error.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.372041"
      },
      {
        "template_path": "templates/first_time_setup.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.373409"
      },
      {
        "template_path": "templates/health_dashboard.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.374196"
      },
      {
        "template_path": "templates/includes/favicon_meta.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.374556"
      },
      {
        "template_path": "templates/index.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.375532"
      },
      {
        "template_path": "templates/login.html",
        "csrf_protected": true,
        "csrf_method": "hidden_tag",
        "vulnerabilities": [],
        "recommendations": [
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 1,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.376041"
      },
      {
        "template_path": "templates/platform_management.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "csrf_in_comment",
            "severity": "MEDIUM",
            "description": "CSRF token or reference found in HTML comment",
            "line_number": 1,
            "code_snippet": null,
            "recommendation": "Remove CSRF references from HTML comments"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Remove CSRF references from HTML comments"
        ],
        "compliance_score": 0.7,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.376659"
      },
      {
        "template_path": "templates/profile.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [
          "/api/update_user_settings"
        ],
        "last_audited": "2025-08-12T08:04:36.380757"
      },
      {
        "template_path": "templates/review.html",
        "csrf_protected": true,
        "csrf_method": "none",
        "vulnerabilities": [],
        "recommendations": [],
        "compliance_score": 1.0,
        "form_count": 0,
        "post_form_count": 0,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.381262"
      },
      {
        "template_path": "templates/review_batch.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 88,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "unnecessary_csrf_token",
            "severity": "LOW",
            "description": "CSRF token found in GET form (unnecessary)",
            "line_number": 87,
            "code_snippet": null,
            "recommendation": "Remove CSRF token from GET forms as they should be idempotent"
          },
          {
            "type": "csrf_in_comment",
            "severity": "MEDIUM",
            "description": "CSRF token or reference found in HTML comment",
            "line_number": 1,
            "code_snippet": null,
            "recommendation": "Remove CSRF references from HTML comments"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Remove CSRF token from GET forms as they should be idempotent",
          "Remove CSRF references from HTML comments",
          "Verify GET forms are idempotent and do not change server state"
        ],
        "compliance_score": 0.45,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 1,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.384176"
      },
      {
        "template_path": "templates/review_batches.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 22,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "unnecessary_csrf_token",
            "severity": "LOW",
            "description": "CSRF token found in GET form (unnecessary)",
            "line_number": 21,
            "code_snippet": null,
            "recommendation": "Remove CSRF token from GET forms as they should be idempotent"
          },
          {
            "type": "csrf_in_comment",
            "severity": "MEDIUM",
            "description": "CSRF token or reference found in HTML comment",
            "line_number": 1,
            "code_snippet": null,
            "recommendation": "Remove CSRF references from HTML comments"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Remove CSRF token from GET forms as they should be idempotent",
          "Remove CSRF references from HTML comments",
          "Verify GET forms are idempotent and do not change server state"
        ],
        "compliance_score": 0.45,
        "form_count": 1,
        "post_form_count": 0,
        "get_form_count": 1,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.385346"
      },
      {
        "template_path": "templates/review_single.html",
        "csrf_protected": true,
        "csrf_method": "hidden_tag",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 148,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "csrf_in_comment",
            "severity": "MEDIUM",
            "description": "CSRF token or reference found in HTML comment",
            "line_number": 1,
            "code_snippet": null,
            "recommendation": "Remove CSRF references from HTML comments"
          },
          {
            "type": "csrf_in_visible_script",
            "severity": "MEDIUM",
            "description": "CSRF token directly embedded in visible JavaScript",
            "line_number": 10,
            "code_snippet": null,
            "recommendation": "Use meta tag and document.querySelector for CSRF token access"
          }
        ],
        "recommendations": [
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Remove CSRF references from HTML comments",
          "Use meta tag and document.querySelector for CSRF token access",
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 0.6000000000000001,
        "form_count": 1,
        "post_form_count": 1,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.386714"
      },
      {
        "template_path": "templates/user_management.html",
        "csrf_protected": true,
        "csrf_method": "csrf_token_direct",
        "vulnerabilities": [
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 87,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 129,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "exposed_csrf_token",
            "severity": "HIGH",
            "description": "CSRF token is visible in HTML output instead of being in a hidden field",
            "line_number": 176,
            "code_snippet": "{{ csrf_token() }}",
            "recommendation": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
          },
          {
            "type": "csrf_in_comment",
            "severity": "MEDIUM",
            "description": "CSRF token or reference found in HTML comment",
            "line_number": 1,
            "code_snippet": null,
            "recommendation": "Remove CSRF references from HTML comments"
          }
        ],
        "recommendations": [
          "Replace {{ csrf_token() }} with {{ form.hidden_tag() }} to hide tokens",
          "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}",
          "Remove CSRF references from HTML comments",
          "Ensure all POST forms validate CSRF tokens on the server side"
        ],
        "compliance_score": 0.10000000000000003,
        "form_count": 3,
        "post_form_count": 3,
        "get_form_count": 0,
        "ajax_endpoints": [],
        "last_audited": "2025-08-12T08:04:36.387901"
      }
    ],
    "vulnerability_reference": {
      "exposed_csrf_token": {
        "description": "CSRF token visible in HTML source code",
        "risk": "HIGH - Token can be extracted by malicious scripts",
        "fix": "Use {{ form.hidden_tag() }} instead of {{ csrf_token() }}"
      },
      "missing_csrf_protection": {
        "description": "POST form without CSRF token",
        "risk": "CRITICAL - Form vulnerable to CSRF attacks",
        "fix": "Add {{ form.hidden_tag() }} to all POST forms"
      },
      "unnecessary_csrf_token": {
        "description": "CSRF token in GET form",
        "risk": "LOW - Unnecessary complexity, GET should be idempotent",
        "fix": "Remove CSRF token from GET forms"
      },
      "csrf_in_comment": {
        "description": "CSRF token reference in HTML comment",
        "risk": "MEDIUM - Information disclosure",
        "fix": "Remove CSRF references from HTML comments"
      }
    },
    "csrf_implementation_guide": {
      "best_practices": "Always use {{ form.hidden_tag() }} for POST forms",
      "ajax_implementation": "Use meta tag and X-CSRFToken header for AJAX requests",
      "validation": "Ensure server-side CSRF validation is enabled",
      "testing": "Test CSRF protection with automated security tests"
    },
    "testing_recommendations": [
      "Implement automated CSRF protection tests",
      "Test form submissions without CSRF tokens (should fail)",
      "Test AJAX requests with and without CSRF tokens",
      "Verify CSRF tokens are not visible in HTML source",
      "Test CSRF token expiration and refresh functionality"
    ]
  }
}