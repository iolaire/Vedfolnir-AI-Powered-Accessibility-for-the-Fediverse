<!-- Copyright (C) 2025 iolaire mcfadden. -->
<!-- This program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. -->
<!-- THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. -->

<!-- Admin Notification System -->
<div class="admin-notification-system">
    <!-- Notification Bell -->
    <div class="notification-bell" id="adminNotificationBell">
        <button type="button" class="btn btn-outline-warning position-relative" 
                data-bs-toggle="dropdown" aria-expanded="false"
                title="Admin Notifications">
            <i class="bi bi-bell" id="notificationBellIcon"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" 
                  id="notificationCount" style="display: none;">
                0
            </span>
        </button>
        
        <!-- Notification Dropdown -->
        <div class="dropdown-menu dropdown-menu-end notification-dropdown" style="width: 400px; max-height: 500px; overflow-y: auto;">
            <div class="dropdown-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0">
                    <i class="bi bi-shield-exclamation text-warning"></i>
                    Admin Notifications
                </h6>
                <div class="btn-group btn-group-sm">
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="markAllNotificationsRead()" title="Mark all as read">
                        <i class="bi bi-check-all"></i>
                    </button>
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="clearAllNotifications()" title="Clear all">
                        <i class="bi bi-trash"></i>
                    </button>
                </div>
            </div>
            <div class="dropdown-divider"></div>
            
            <!-- Notification Filters -->
            <div class="px-3 py-2">
                <div class="btn-group btn-group-sm w-100" role="group">
                    <button type="button" class="btn btn-outline-secondary active" onclick="filterNotifications('all')" id="filterAll">
                        All <span class="badge bg-secondary ms-1" id="countAll">0</span>
                    </button>
                    <button type="button" class="btn btn-outline-danger" onclick="filterNotifications('critical')" id="filterCritical">
                        Critical <span class="badge bg-danger ms-1" id="countCritical">0</span>
                    </button>
                    <button type="button" class="btn btn-outline-warning" onclick="filterNotifications('warning')" id="filterWarning">
                        Warning <span class="badge bg-warning text-dark ms-1" id="countWarning">0</span>
                    </button>
                    <button type="button" class="btn btn-outline-info" onclick="filterNotifications('info')" id="filterInfo">
                        Info <span class="badge bg-info ms-1" id="countInfo">0</span>
                    </button>
                </div>
            </div>
            <div class="dropdown-divider"></div>
            
            <!-- Notifications List -->
            <div id="notificationsList" class="notifications-list">
                <!-- Notifications will be populated here -->
            </div>
            
            <!-- Empty State -->
            <div id="notificationsEmptyState" class="text-center py-4" style="display: none;">
                <i class="bi bi-bell-slash text-muted" style="font-size: 2rem;"></i>
                <p class="text-muted mb-0">No notifications</p>
            </div>
            
            <div class="dropdown-divider"></div>
            <div class="dropdown-item-text text-center">
                <button type="button" class="btn btn-outline-primary btn-sm" onclick="showAllNotifications()">
                    <i class="bi bi-list-ul"></i> View All Notifications
                </button>
            </div>
        </div>
    </div>
    
    <!-- Toast Container for Real-time Notifications -->
    <div class="toast-container position-fixed top-0 end-0 p-3" id="adminToastContainer">
        <!-- Toasts will be added here dynamically -->
    </div>
</div>

<!-- Admin Notifications Modal -->
<div class="modal fade" id="adminNotificationsModal" tabindex="-1" aria-labelledby="adminNotificationsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="adminNotificationsModalLabel">
                    <i class="bi bi-bell"></i> Admin Notifications
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Notification Management Controls -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-secondary active" onclick="showModalNotifications('all')" id="modalFilterAll">
                                All
                            </button>
                            <button type="button" class="btn btn-outline-danger" onclick="showModalNotifications('critical')" id="modalFilterCritical">
                                Critical
                            </button>
                            <button type="button" class="btn btn-outline-warning" onclick="showModalNotifications('warning')" id="modalFilterWarning">
                                Warning
                            </button>
                            <button type="button" class="btn btn-outline-info" onclick="showModalNotifications('info')" id="modalFilterInfo">
                                Info
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6 text-end">
                        <div class="btn-group">
                            <button type="button" class="btn btn-outline-success" onclick="markAllModalNotificationsRead()">
                                <i class="bi bi-check-all"></i> Mark All Read
                            </button>
                            <button type="button" class="btn btn-outline-danger" onclick="clearAllModalNotifications()">
                                <i class="bi bi-trash"></i> Clear All
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Notifications List -->
                <div id="modalNotificationsList" class="modal-notifications-list" style="max-height: 400px; overflow-y: auto;">
                    <!-- Modal notifications will be populated here -->
                </div>
            </div>
            <div class="modal-footer">
                <div class="me-auto">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="enableDesktopNotifications" onchange="toggleDesktopNotifications()">
                        <label class="form-check-label" for="enableDesktopNotifications">
                            Enable desktop notifications
                        </label>
                    </div>
                </div>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<style>
.admin-notification-system {
    position: relative;
}

.notification-bell .btn {
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.notification-bell .btn:hover {
    background-color: rgba(255, 193, 7, 0.1);
}

.notification-dropdown {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    border: 1px solid #ffc107;
}

.notification-item {
    padding: 12px 16px;
    border-bottom: 1px solid #f8f9fa;
    cursor: pointer;
    transition: background-color 0.2s ease;
    position: relative;
}

.notification-item:hover {
    background-color: #f8f9fa;
}

.notification-item.unread {
    background-color: rgba(255, 193, 7, 0.1);
    border-left: 3px solid #ffc107;
}

.notification-item.critical {
    border-left: 3px solid #dc3545;
}

.notification-item.warning {
    border-left: 3px solid #ffc107;
}

.notification-item.info {
    border-left: 3px solid #0dcaf0;
}

.notification-item.success {
    border-left: 3px solid #198754;
}

.notification-content {
    display: flex;
    align-items: flex-start;
    gap: 12px;
}

.notification-icon {
    font-size: 1.2rem;
    margin-top: 2px;
    flex-shrink: 0;
}

.notification-icon.critical {
    color: #dc3545;
}

.notification-icon.warning {
    color: #ffc107;
}

.notification-icon.info {
    color: #0dcaf0;
}

.notification-icon.success {
    color: #198754;
}

.notification-body {
    flex: 1;
    min-width: 0;
}

.notification-title {
    font-weight: 600;
    font-size: 0.9rem;
    margin-bottom: 4px;
    line-height: 1.3;
}

.notification-message {
    font-size: 0.8rem;
    color: #6c757d;
    line-height: 1.4;
    margin-bottom: 4px;
}

.notification-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.75rem;
    color: #6c757d;
}

.notification-time {
    flex-shrink: 0;
}

.notification-actions {
    display: flex;
    gap: 4px;
}

.notification-actions .btn {
    font-size: 0.7rem;
    padding: 2px 6px;
}

.notification-badge {
    position: absolute;
    top: 8px;
    right: 8px;
    font-size: 0.6rem;
    padding: 2px 4px;
}

.notifications-list {
    max-height: 300px;
    overflow-y: auto;
}

.modal-notifications-list .notification-item {
    margin-bottom: 8px;
    border: 1px solid #dee2e6;
    border-radius: 6px;
}

/* Toast Notifications */
.admin-toast {
    background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
    border: 1px solid #ffc107;
    border-left: 4px solid #ffc107;
    color: #856404;
}

.admin-toast.critical {
    background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
    border-color: #dc3545;
    border-left-color: #dc3545;
    color: #721c24;
}

.admin-toast.success {
    background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
    border-color: #198754;
    border-left-color: #198754;
    color: #155724;
}

.admin-toast .toast-header {
    background: transparent;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.admin-toast .toast-body {
    font-size: 0.9rem;
}

/* Animation for notification bell */
.notification-bell-shake {
    animation: bellShake 0.5s ease-in-out;
}

@keyframes bellShake {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(-10deg); }
    75% { transform: rotate(10deg); }
}

/* Pulsing effect for unread notifications */
.notification-count-pulse {
    animation: countPulse 2s infinite;
}

@keyframes countPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .notification-dropdown {
        width: 350px !important;
        max-width: 90vw;
    }
    
    .notification-content {
        gap: 8px;
    }
    
    .notification-icon {
        font-size: 1rem;
    }
    
    .notification-title {
        font-size: 0.85rem;
    }
    
    .notification-message {
        font-size: 0.75rem;
    }
}
</style>

<script>
// Admin Notification System
class AdminNotificationSystem {
    constructor() {
        this.notifications = [];
        this.unreadCount = 0;
        this.currentFilter = 'all';
        this.websocket = null;
        this.desktopNotificationsEnabled = false;
        
        this.init();
    }
    
    init() {
        this.loadNotifications();
        this.setupWebSocket();
        this.checkDesktopNotificationPermission();
        this.startPeriodicRefresh();
    }
    
    loadNotifications() {
        fetch('/admin/api/notifications', {
            headers: {
                'X-CSRFToken': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            }
        })
        .then(response => response.json())
        .then(data => {
            this.notifications = data.notifications || [];
            this.updateNotificationDisplay();
        })
        .catch(error => {
            console.error('Error loading notifications:', error);
        });
    }
    
    setupWebSocket() {
        // TODO: Implement WebSocket connection for real-time notifications
        console.log('Setting up WebSocket for real-time notifications');
    }
    
    addNotification(notification) {
        // Add timestamp if not present
        if (!notification.timestamp) {
            notification.timestamp = new Date().toISOString();
        }
        
        // Add unique ID if not present
        if (!notification.id) {
            notification.id = 'notif_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        // Set default values
        notification.read = notification.read || false;
        notification.severity = notification.severity || 'info';
        
        // Add to beginning of array
        this.notifications.unshift(notification);
        
        // Limit to 100 notifications
        if (this.notifications.length > 100) {
            this.notifications = this.notifications.slice(0, 100);
        }
        
        this.updateNotificationDisplay();
        this.showToastNotification(notification);
        this.animateNotificationBell();
        
        // Show desktop notification if enabled
        if (this.desktopNotificationsEnabled && !notification.read) {
            this.showDesktopNotification(notification);
        }
    }
    
    updateNotificationDisplay() {
        this.unreadCount = this.notifications.filter(n => !n.read).length;
        
        // Update notification count badge
        const countBadge = document.getElementById('notificationCount');
        if (this.unreadCount > 0) {
            countBadge.textContent = this.unreadCount > 99 ? '99+' : this.unreadCount;
            countBadge.style.display = 'block';
            countBadge.classList.add('notification-count-pulse');
        } else {
            countBadge.style.display = 'none';
            countBadge.classList.remove('notification-count-pulse');
        }
        
        // Update filter counts
        const counts = {
            all: this.notifications.length,
            critical: this.notifications.filter(n => n.severity === 'critical').length,
            warning: this.notifications.filter(n => n.severity === 'warning').length,
            info: this.notifications.filter(n => n.severity === 'info').length
        };
        
        Object.keys(counts).forEach(type => {
            const element = document.getElementById(`count${type.charAt(0).toUpperCase() + type.slice(1)}`);
            if (element) {
                element.textContent = counts[type];
            }
        });
        
        this.renderNotifications();
    }
    
    renderNotifications() {
        const container = document.getElementById('notificationsList');
        const filteredNotifications = this.getFilteredNotifications();
        
        if (filteredNotifications.length === 0) {
            document.getElementById('notificationsEmptyState').style.display = 'block';
            container.innerHTML = '';
            return;
        }
        
        document.getElementById('notificationsEmptyState').style.display = 'none';
        
        container.innerHTML = filteredNotifications.map(notification => 
            this.renderNotificationItem(notification)
        ).join('');
    }
    
    renderNotificationItem(notification) {
        const timeAgo = this.formatTimeAgo(notification.timestamp);
        const iconClass = this.getNotificationIcon(notification.type, notification.severity);
        
        return `
            <div class="notification-item ${notification.read ? '' : 'unread'} ${notification.severity}" 
                 data-notification-id="${notification.id}"
                 onclick="handleNotificationClick('${notification.id}')">
                <div class="notification-content">
                    <div class="notification-icon ${notification.severity}">
                        <i class="bi ${iconClass}"></i>
                    </div>
                    <div class="notification-body">
                        <div class="notification-title">${notification.title}</div>
                        <div class="notification-message">${notification.message}</div>
                        <div class="notification-meta">
                            <span class="notification-time">${timeAgo}</span>
                            <div class="notification-actions">
                                ${!notification.read ? `
                                    <button class="btn btn-outline-secondary btn-sm" onclick="markNotificationRead('${notification.id}', event)">
                                        <i class="bi bi-check"></i>
                                    </button>
                                ` : ''}
                                <button class="btn btn-outline-danger btn-sm" onclick="deleteNotification('${notification.id}', event)">
                                    <i class="bi bi-x"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                ${!notification.read ? '<span class="notification-badge badge bg-primary">New</span>' : ''}
            </div>
        `;
    }
    
    getFilteredNotifications() {
        if (this.currentFilter === 'all') {
            return this.notifications;
        }
        return this.notifications.filter(n => n.severity === this.currentFilter);
    }
    
    getNotificationIcon(type, severity) {
        const iconMap = {
            'job_completed': 'bi-check-circle',
            'job_failed': 'bi-exclamation-triangle',
            'job_cancelled': 'bi-x-circle',
            'system_alert': 'bi-exclamation-diamond',
            'user_action': 'bi-person-exclamation',
            'system_maintenance': 'bi-tools',
            'security_alert': 'bi-shield-exclamation',
            'performance_alert': 'bi-speedometer2'
        };
        
        return iconMap[type] || (severity === 'critical' ? 'bi-exclamation-triangle' : 'bi-info-circle');
    }
    
    showToastNotification(notification) {
        const toastContainer = document.getElementById('adminToastContainer');
        const toastId = 'toast_' + notification.id;
        
        const toastHtml = `
            <div class="toast admin-toast ${notification.severity}" id="${toastId}" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="toast-header">
                    <i class="bi ${this.getNotificationIcon(notification.type, notification.severity)} me-2"></i>
                    <strong class="me-auto">${notification.title}</strong>
                    <small class="text-muted">now</small>
                    <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body">
                    ${notification.message}
                </div>
            </div>
        `;
        
        toastContainer.insertAdjacentHTML('beforeend', toastHtml);
        
        const toastElement = document.getElementById(toastId);
        const toast = new bootstrap.Toast(toastElement, {
            delay: notification.severity === 'critical' ? 10000 : 5000
        });
        
        toast.show();
        
        // Remove toast element after it's hidden
        toastElement.addEventListener('hidden.bs.toast', () => {
            toastElement.remove();
        });
    }
    
    showDesktopNotification(notification) {
        if ('Notification' in window && Notification.permission === 'granted') {
            const desktopNotification = new Notification(notification.title, {
                body: notification.message,
                icon: '/static/images/Logo.png',
                tag: notification.id,
                requireInteraction: notification.severity === 'critical'
            });
            
            desktopNotification.onclick = () => {
                window.focus();
                this.handleNotificationClick(notification.id);
                desktopNotification.close();
            };
        }
    }
    
    animateNotificationBell() {
        const bell = document.getElementById('adminNotificationBell');
        bell.classList.add('notification-bell-shake');
        setTimeout(() => {
            bell.classList.remove('notification-bell-shake');
        }, 500);
    }
    
    markNotificationRead(notificationId) {
        const notification = this.notifications.find(n => n.id === notificationId);
        if (notification && !notification.read) {
            notification.read = true;
            this.updateNotificationDisplay();
            
            // Send to server
            fetch(`/admin/api/notifications/${notificationId}/read`, {
                method: 'POST',
                headers: {
                    'X-CSRFToken': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
                }
            }).catch(error => {
                console.error('Error marking notification as read:', error);
            });
        }
    }
    
    deleteNotification(notificationId) {
        this.notifications = this.notifications.filter(n => n.id !== notificationId);
        this.updateNotificationDisplay();
        
        // Send to server
        fetch(`/admin/api/notifications/${notificationId}`, {
            method: 'DELETE',
            headers: {
                'X-CSRFToken': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            }
        }).catch(error => {
            console.error('Error deleting notification:', error);
        });
    }
    
    markAllNotificationsRead() {
        this.notifications.forEach(n => n.read = true);
        this.updateNotificationDisplay();
        
        fetch('/admin/api/notifications/mark-all-read', {
            method: 'POST',
            headers: {
                'X-CSRFToken': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            }
        }).catch(error => {
            console.error('Error marking all notifications as read:', error);
        });
    }
    
    clearAllNotifications() {
        if (confirm('Are you sure you want to clear all notifications? This action cannot be undone.')) {
            this.notifications = [];
            this.updateNotificationDisplay();
            
            fetch('/admin/api/notifications/clear-all', {
                method: 'POST',
                headers: {
                    'X-CSRFToken': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
                }
            }).catch(error => {
                console.error('Error clearing all notifications:', error);
            });
        }
    }
    
    filterNotifications(type) {
        this.currentFilter = type;
        
        // Update filter buttons
        document.querySelectorAll('[id^="filter"]').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(`filter${type.charAt(0).toUpperCase() + type.slice(1)}`).classList.add('active');
        
        this.renderNotifications();
    }
    
    handleNotificationClick(notificationId) {
        const notification = this.notifications.find(n => n.id === notificationId);
        if (!notification) return;
        
        // Mark as read
        this.markNotificationRead(notificationId);
        
        // Handle notification action based on type
        switch (notification.type) {
            case 'job_completed':
            case 'job_failed':
            case 'job_cancelled':
                if (notification.job_id) {
                    viewJobDetails(notification.job_id, true);
                }
                break;
            case 'system_alert':
                // Navigate to system health dashboard
                window.location.href = '/admin/health';
                break;
            case 'security_alert':
                // Navigate to security audit dashboard
                window.location.href = '/admin/security-audit';
                break;
            default:
                // Default action - just mark as read
                break;
        }
    }
    
    checkDesktopNotificationPermission() {
        if ('Notification' in window) {
            if (Notification.permission === 'granted') {
                this.desktopNotificationsEnabled = localStorage.getItem('admin_desktop_notifications') === 'true';
                document.getElementById('enableDesktopNotifications').checked = this.desktopNotificationsEnabled;
            } else if (Notification.permission === 'default') {
                // Permission not yet requested
                document.getElementById('enableDesktopNotifications').checked = false;
            } else {
                // Permission denied
                document.getElementById('enableDesktopNotifications').disabled = true;
                document.getElementById('enableDesktopNotifications').checked = false;
            }
        } else {
            // Notifications not supported
            document.getElementById('enableDesktopNotifications').disabled = true;
        }
    }
    
    toggleDesktopNotifications() {
        const checkbox = document.getElementById('enableDesktopNotifications');
        
        if (checkbox.checked) {
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        this.desktopNotificationsEnabled = true;
                        localStorage.setItem('admin_desktop_notifications', 'true');
                    } else {
                        checkbox.checked = false;
                        this.desktopNotificationsEnabled = false;
                        localStorage.setItem('admin_desktop_notifications', 'false');
                    }
                });
            }
        } else {
            this.desktopNotificationsEnabled = false;
            localStorage.setItem('admin_desktop_notifications', 'false');
        }
    }
    
    startPeriodicRefresh() {
        // Refresh notifications every 30 seconds
        setInterval(() => {
            this.loadNotifications();
        }, 30000);
    }
    
    formatTimeAgo(timestamp) {
        const now = new Date();
        const time = new Date(timestamp);
        const diffMs = now - time;
        const diffMins = Math.floor(diffMs / 60000);
        const diffHours = Math.floor(diffMins / 60);
        const diffDays = Math.floor(diffHours / 24);
        
        if (diffMins < 1) return 'Just now';
        if (diffMins < 60) return `${diffMins}m ago`;
        if (diffHours < 24) return `${diffHours}h ago`;
        return `${diffDays}d ago`;
    }
}

// Initialize notification system
let adminNotificationSystem;

document.addEventListener('DOMContentLoaded', function() {
    adminNotificationSystem = new AdminNotificationSystem();
});

// Global functions for template usage
function markAllNotificationsRead() {
    adminNotificationSystem.markAllNotificationsRead();
}

function clearAllNotifications() {
    adminNotificationSystem.clearAllNotifications();
}

function filterNotifications(type) {
    adminNotificationSystem.filterNotifications(type);
}

function markNotificationRead(notificationId, event) {
    if (event) {
        event.stopPropagation();
    }
    adminNotificationSystem.markNotificationRead(notificationId);
}

function deleteNotification(notificationId, event) {
    if (event) {
        event.stopPropagation();
    }
    adminNotificationSystem.deleteNotification(notificationId);
}

function handleNotificationClick(notificationId) {
    adminNotificationSystem.handleNotificationClick(notificationId);
}

function showAllNotifications() {
    const modal = new bootstrap.Modal(document.getElementById('adminNotificationsModal'));
    modal.show();
}

function toggleDesktopNotifications() {
    adminNotificationSystem.toggleDesktopNotifications();
}

// Functions for modal
function showModalNotifications(type) {
    // TODO: Implement modal notification filtering
    console.log('Showing modal notifications for type:', type);
}

function markAllModalNotificationsRead() {
    adminNotificationSystem.markAllNotificationsRead();
}

function clearAllModalNotifications() {
    adminNotificationSystem.clearAllNotifications();
}

// Export for global access
window.adminNotificationSystem = adminNotificationSystem;
</script>